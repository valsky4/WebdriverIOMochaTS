{"version":3,"file":"element.js","names":["_lodash","_interopRequireDefault","require","_driver","_support","commands","extensions","exports","elementDisplayed","el","util","unwrapElement","isWebContext","atomsElement","getAtomsElement","executeAtom","proxyCommand","elementEnabled","elementSelected","getName","script","getNativeAttribute","attribute","getContentSize","value","includes","_","isNull","isString","JSON","stringify","getAttribute","getProperty","property","getText","getElementRect","x","y","getLocation","width","height","getSize","getNativeRect","loc","opts","absoluteWebLocations","xOffset","yOffset","execute","rect","getLocationInView","prepareInputValue","inp","isArray","isFinite","some","f","Error","join","map","k","setValueImmediate","log","info","setValue","keys","clear","errors","NotYetImplementedError","type","locator","contentHeight","children","findElOrEls","length","head","firstRect","lastRect","last","elsInRow","initialRects","i","push","spaceBetweenEls","numRows","Math","ceil","size","origin","top","left","scrollableOffset","isKeyboardShown","findNativeElementOrElements","ign","Object","assign","_default","default"],"sources":["../../../lib/commands/element.js"],"sourcesContent":["import _ from 'lodash';\nimport { errors } from 'appium/driver';\nimport { util } from 'appium/support';\n\n\nconst commands = {}, extensions = {};\n\ncommands.elementDisplayed = async function elementDisplayed (el) {\n  el = util.unwrapElement(el);\n  if (this.isWebContext()) {\n    const atomsElement = this.getAtomsElement(el);\n    return await this.executeAtom('is_displayed', [atomsElement]);\n  }\n\n  return await this.proxyCommand(`/element/${el}/displayed`, 'GET');\n};\n\ncommands.elementEnabled = async function elementEnabled (el) {\n  el = util.unwrapElement(el);\n  if (this.isWebContext()) {\n    const atomsElement = this.getAtomsElement(el);\n    return await this.executeAtom('is_enabled', [atomsElement]);\n  }\n\n  return await this.proxyCommand(`/element/${el}/enabled`, 'GET');\n};\n\ncommands.elementSelected = async function elementSelected (el) {\n  el = util.unwrapElement(el);\n  if (this.isWebContext()) {\n    const atomsElement = this.getAtomsElement(el);\n    return await this.executeAtom('is_selected', [atomsElement]);\n  }\n\n  return await this.proxyCommand(`/element/${el}/selected`, 'GET');\n};\n\ncommands.getName = async function getName (el) {\n  el = util.unwrapElement(el);\n  if (this.isWebContext()) {\n    const atomsElement = this.getAtomsElement(el);\n    const script = 'return arguments[0].tagName.toLowerCase()';\n    return await this.executeAtom('execute_script', [script, [atomsElement]]);\n  }\n\n  return await this.proxyCommand(`/element/${el}/name`, 'GET');\n};\n\ncommands.getNativeAttribute = async function getNativeAttribute (attribute, el) {\n  if (attribute === 'contentSize') {\n    // don't proxy requests for the content size of a scrollable element\n    return await this.getContentSize(el);\n  }\n\n  el = util.unwrapElement(el);\n\n  // otherwise let WDA handle attribute requests\n  let value = await this.proxyCommand(`/element/${el}/attribute/${attribute}`, 'GET');\n  // Transform the result for the case when WDA returns an integer representation for a boolean value\n  if ([0, 1].includes(value)) {\n    value = !!value;\n  }\n  // The returned value must be of type string according to https://www.w3.org/TR/webdriver/#get-element-attribute\n  return (_.isNull(value) || _.isString(value)) ? value : JSON.stringify(value);\n};\n\ncommands.getAttribute = async function getAttribute (attribute, el) {\n  el = util.unwrapElement(el);\n  if (!this.isWebContext()) {\n    return await this.getNativeAttribute(attribute, el);\n  }\n  const atomsElement = this.getAtomsElement(el);\n  return await this.executeAtom('get_attribute_value', [atomsElement, attribute]);\n};\n\ncommands.getProperty = async function getProperty (property, el) {\n  el = util.unwrapElement(el);\n  if (!this.isWebContext()) {\n    return await this.getNativeAttribute(property, el);\n  }\n  const atomsElement = this.getAtomsElement(el);\n  return await this.executeAtom('get_attribute_value', [atomsElement, property]);\n};\n\ncommands.getText = async function getText (el) {\n  el = util.unwrapElement(el);\n  if (!this.isWebContext()) {\n    return await this.proxyCommand(`/element/${el}/text`, 'GET');\n  }\n  let atomsElement = this.getAtomsElement(el);\n  return await this.executeAtom('get_text', [atomsElement]);\n};\n\ncommands.getElementRect = async function getElementRect (el) {\n  if (this.isWebContext()) {\n    // Mobile safari doesn't support rect\n    const {x, y} = await this.getLocation(el);\n    const {width, height} = await this.getSize(el);\n    return {x, y, width, height};\n  }\n\n  el = util.unwrapElement(el);\n  return await this.getNativeRect(el);\n};\n\nextensions.getNativeRect = async function getNativeRect (el) {\n  return await this.proxyCommand(`/element/${el}/rect`, 'GET');\n};\n\ncommands.getLocation = async function getLocation (el) {\n  el = util.unwrapElement(el);\n  if (this.isWebContext()) {\n    const atomsElement = await this.getAtomsElement(el);\n    let loc = await this.executeAtom('get_top_left_coordinates', [atomsElement]);\n    if (this.opts.absoluteWebLocations) {\n      const script = 'return [' +\n        'Math.max(window.pageXOffset,document.documentElement.scrollLeft,document.body.scrollLeft),' +\n        'Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)];';\n      const [xOffset, yOffset] = await this.execute(script);\n      loc.x += xOffset;\n      loc.y += yOffset;\n    }\n    return loc;\n  }\n\n  const rect = await this.getElementRect(el);\n  return {x: rect.x, y: rect.y};\n};\n\ncommands.getLocationInView = async function getLocationInView (el) {\n  return await this.getLocation(el);\n};\n\ncommands.getSize = async function getSize (el) {\n  el = util.unwrapElement(el);\n  if (this.isWebContext()) {\n    return await this.executeAtom('get_size', [this.getAtomsElement(el)]);\n  }\n\n  const rect = await this.getElementRect(el);\n  return {width: rect.width, height: rect.height};\n};\n\n/**\n * Prepares the input value to be passed as an argument to WDA.\n *\n * @param {string|Array<string>|number} inp The actual text to type.\n * Acceptable values of `inp`:\n *   ['some text']\n *   ['s', 'o', 'm', 'e', ' ', 't', 'e', 'x', 't']\n *   'some text'\n *   1234\n * @throws {Error} If the value is not acceptable for input\n * @returns {Array<string>} The preprocessed value\n */\nfunction prepareInputValue (inp) {\n  if (![_.isArray, _.isString, _.isFinite].some((f) => f(inp))) {\n    throw new Error(`Only strings, numbers and arrays are supported as input arguments. ` +\n      `Received: ${JSON.stringify(inp)}`);\n  }\n\n  // make it into a string, so then we assure\n  // the array items are single characters\n  if (_.isArray(inp)) {\n    inp = inp.join('');\n  } else if (_.isFinite(inp)) {\n    inp = `${inp}`;\n  }\n  // The `split` method must not be used on the string\n  // to properly handle all Unicode code points\n  return [...inp].map((k) => {\n    if (['\\uE006', '\\uE007'].includes(k)) { // RETURN or ENTER\n      return '\\n';\n    }\n    if (['\\uE003', '\\ue017'].includes(k)) { // BACKSPACE or DELETE\n      return '\\b';\n    }\n    return k;\n  });\n}\n\ncommands.setValueImmediate = async function setValueImmediate (value, el) {\n  // WDA does not provide no way to set the value directly\n  this.log.info('There is currently no way to bypass typing using XCUITest. Setting value through keyboard');\n  await this.setValue(value, el);\n};\n\ncommands.setValue = async function setValue (value, el) {\n  el = util.unwrapElement(el);\n  if (!this.isWebContext()) {\n    await this.proxyCommand(`/element/${el}/value`, 'POST', {\n      value: prepareInputValue(value),\n    });\n    return;\n  }\n\n  const atomsElement = this.getAtomsElement(el);\n  await this.executeAtom('click', [atomsElement]);\n  await this.executeAtom('type', [atomsElement, value]);\n};\n\ncommands.keys = async function keys (value) {\n  await this.proxyCommand('/wda/keys', 'POST', {\n    value: prepareInputValue(value),\n  });\n};\n\ncommands.clear = async function clear (el) {\n  el = util.unwrapElement(el);\n  if (this.isWebContext()) {\n    const atomsElement = this.getAtomsElement(el);\n    await this.executeAtom('clear', [atomsElement]);\n    return;\n  }\n  await this.proxyCommand(`/element/${el}/clear`, 'POST');\n};\n\ncommands.getContentSize = async function getContentSize (el) {\n  if (this.isWebContext()) {\n    throw new errors.NotYetImplementedError('Support for getContentSize for web context is not yet implemented. Please contact an Appium dev');\n  }\n\n  const type = await this.getAttribute('type', el);\n\n  if (type !== 'XCUIElementTypeTable' &&\n      type !== 'XCUIElementTypeCollectionView') {\n    throw new Error(`Can't get content size for type '${type}', only for ` +\n                    `tables and collection views`);\n  }\n  let locator = '*';\n  if (type === 'XCUIElementTypeTable') {\n    // only find table cells, not just any children\n    locator = 'XCUIElementTypeCell';\n  }\n\n  let contentHeight = 0;\n  const children = await this.findElOrEls(`class chain`, locator, true, el);\n  if (children.length === 1) {\n    // if we know there's only one element, we can optimize to make just one\n    // call to WDA\n    const rect = await this.getElementRect(_.head(children));\n    contentHeight = rect.height;\n  } else if (children.length) {\n    // otherwise if we have multiple elements, logic differs based on element\n    // type\n    switch (type) {\n      case 'XCUIElementTypeTable': {\n        const firstRect = await this.getElementRect(_.head(children));\n        const lastRect = await this.getElementRect(_.last(children));\n        contentHeight = lastRect.y + lastRect.height - firstRect.y;\n        break;\n      }\n      case 'XCUIElementTypeCollectionView': {\n        let elsInRow = 1; // we know there must be at least one element in the row\n        let firstRect = await this.getElementRect(_.head(children));\n        let initialRects = [firstRect];\n        for (let i = 1; i < children.length; i++) {\n          const rect = await this.getElementRect(children[i]);\n          initialRects.push(rect);\n          if (rect.y !== firstRect.y) {\n            elsInRow = i;\n            break;\n          }\n        }\n        const spaceBetweenEls = initialRects[elsInRow].y - initialRects[elsInRow - 1].y - initialRects[elsInRow - 1].height;\n        const numRows = Math.ceil(children.length / elsInRow);\n\n        // assume all cells are the same height\n        contentHeight = (numRows * firstRect.height) + (spaceBetweenEls * (numRows - 1));\n        break;\n      }\n      default: throw new Error(`Programming error: type '${type}' was not ` +\n                               `valid but should have already been rejected`);\n    }\n  }\n  const size = await this.getSize(el);\n  const origin = await this.getLocationInView(el);\n  // attributes have to be strings, so stringify this up\n  return JSON.stringify({\n    width: size.width,\n    height: size.height,\n    top: origin.y,\n    left: origin.x,\n    scrollableOffset: contentHeight\n  });\n};\n\ncommands.isKeyboardShown = async function isKeyboardShown () {\n  try {\n    await this.findNativeElementOrElements('class name', 'XCUIElementTypeKeyboard', false);\n    return true;\n  } catch (ign) {\n    return false;\n  }\n};\n\nObject.assign(extensions, commands);\nexport { commands };\nexport default extensions;\n"],"mappings":"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"}