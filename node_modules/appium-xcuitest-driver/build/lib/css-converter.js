"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
require("source-map-support/register");
var _cssSelectorParser = require("css-selector-parser");
var _lodash = _interopRequireDefault(require("lodash"));
var _driver = require("appium/driver");
const CssConverter = {};
const parser = new _cssSelectorParser.CssSelectorParser();
parser.registerSelectorPseudos('has');
parser.registerNestingOperators('>', '+', '~');
parser.registerAttrEqualityMods('^', '$', '*', '~');
parser.enableSubstitutes();
const BOOLEAN_ATTRS = ['visible', 'accessible', 'accessibility-container', 'enabled'];
const NUMERIC_ATTRS = ['index'];
const STR_ATTRS = ['label', 'name', 'value', 'type'];
const ALL_ATTRS = [...BOOLEAN_ATTRS, ...NUMERIC_ATTRS, ...STR_ATTRS];
const ATTRIBUTE_ALIASES = [['name', ['id']], ['index', ['nth-child']]];
function toCamelCase(str) {
  if (!str) {
    return '';
  }
  const tokens = str.split('-').map(str => str.charAt(0).toUpperCase() + str.slice(1).toLowerCase());
  const out = tokens.join('');
  return out.charAt(0).toLowerCase() + out.slice(1);
}
function requireBoolean(css) {
  var _css$value;
  const val = ((_css$value = css.value) === null || _css$value === void 0 ? void 0 : _css$value.toLowerCase()) || 'true';
  switch (val) {
    case '0':
    case 'false':
      return '0';
    case '1':
    case 'true':
      return '1';
    default:
      throw new TypeError(`'${css.name}' must be true, false or empty. Found '${css.value}'`);
  }
}
function requireAttributeName(css) {
  const attrName = css.name.toLowerCase();
  if (ALL_ATTRS.includes(attrName)) {
    return attrName.toLowerCase();
  }
  for (const [officialAttr, aliasAttrs] of ATTRIBUTE_ALIASES) {
    if (aliasAttrs.includes(attrName)) {
      return officialAttr;
    }
  }
  throw new Error(`'${attrName}' is not a valid attribute. ` + `Supported attributes are '${ALL_ATTRS.join(', ')}'`);
}
function parseAttr(cssAttr) {
  if (cssAttr.valueType && cssAttr.valueType !== 'string') {
    throw new TypeError(`'${cssAttr.name}=${cssAttr.value}' is an invalid attribute. ` + `Only 'string' and empty attribute types are supported. Found '${cssAttr.valueType}'`);
  }
  const attrName = toCamelCase(requireAttributeName(cssAttr));
  if (!STR_ATTRS.includes(attrName) && !BOOLEAN_ATTRS.includes(attrName)) {
    throw new Error(`'${attrName}' is not supported. Supported attributes are ` + `'${[...STR_ATTRS, ...BOOLEAN_ATTRS].join(', ')}'`);
  }
  if (attrName === 'index') {
    return {
      index: cssAttr.value
    };
  }
  if (BOOLEAN_ATTRS.includes(attrName)) {
    return `${attrName} == ${requireBoolean(cssAttr)}`;
  }
  let value = cssAttr.value || '';
  if (value === '') {
    return `[${attrName} LIKE ${value}]`;
  }
  switch (cssAttr.operator) {
    case '=':
      return `${attrName} == "${value}"`;
    case '*=':
      return `${attrName} MATCHES "${_lodash.default.escapeRegExp(value)}"`;
    case '^=':
      return `${attrName} BEGINSWITH "${value}"`;
    case '$=':
      return `${attrName} ENDSWITH "${value}"`;
    case '~=':
      return `${attrName} CONTAINS "${value}"`;
    default:
      throw new Error(`Unsupported CSS attribute operator '${cssAttr.operator}'. ` + ` '=', '*=', '^=', '$=' and '~=' are supported.`);
  }
}
function parsePseudo(cssPseudo) {
  if (cssPseudo.valueType && cssPseudo.valueType !== 'string') {
    throw new Error(`'${cssPseudo.name}=${cssPseudo.value}'. ` + `Unsupported css pseudo class value type: '${cssPseudo.valueType}'. Only 'string' type or empty is supported.`);
  }
  const pseudoName = requireAttributeName(cssPseudo);
  if (BOOLEAN_ATTRS.includes(pseudoName)) {
    return `${toCamelCase(pseudoName)} == ${requireBoolean(cssPseudo)}`;
  }
  if (pseudoName === 'index') {
    return {
      index: cssPseudo.value
    };
  }
}
function parseCssRule(cssRule) {
  const {
    nestingOperator
  } = cssRule;
  if (nestingOperator && nestingOperator !== ' ' && nestingOperator !== '>') {
    throw new Error(`'${nestingOperator}' is not a supported combinator. ` + `Only child combinator (>) and descendant combinator are supported.`);
  }
  let iosClassChainSelector = '';
  if (cssRule.classNames) {
    throw new _driver.errors.InvalidSelectorError(`'${[cssRule || '', ...cssRule.classNames].join('.')}'
      is not a valid ios class. Must be a single string (e.g.: XCUIElementTypeWindow) without
      dots separating them`);
  }
  if (cssRule.tagName && cssRule.tagName !== '*' && !cssRule.tagName.toLowerCase().startsWith('xcuielementtype')) {
    const capitalizedTagName = cssRule.tagName.charAt(0).toUpperCase() + cssRule.tagName.slice(1);
    cssRule.tagName = `XCUIElementType${capitalizedTagName}`;
  }
  iosClassChainSelector += cssRule.tagName || '*';
  let attrs = [];
  if (cssRule.id) {
    attrs.push(`name == "${cssRule.id}"`);
  }
  if (cssRule.attrs) {
    for (const attr of cssRule.attrs) {
      attrs.push(parseAttr(attr));
    }
  }
  if (cssRule.pseudos) {
    for (const pseudo of cssRule.pseudos) {
      attrs.push(parsePseudo(pseudo));
    }
  }
  const nonIndexAttrs = attrs.filter(attr => _lodash.default.isString(attr));
  if (nonIndexAttrs && nonIndexAttrs.length > 0) {
    iosClassChainSelector += `[\`${nonIndexAttrs.join(' AND ')}\`]`;
  }
  const indexAttr = attrs.find(attr => _lodash.default.isObject(attr) && attr.index);
  if (indexAttr) {
    iosClassChainSelector += `[${indexAttr.index}]`;
  }
  if (cssRule.rule) {
    iosClassChainSelector += `/${parseCssRule(cssRule.rule)}`;
  }
  if (cssRule.nestingOperator === '>') {
    return iosClassChainSelector;
  } else {
    return `**/` + iosClassChainSelector;
  }
}
function parseCssObject(css) {
  switch (css.type) {
    case 'rule':
      return parseCssRule(css);
    case 'ruleSet':
      return parseCssObject(css.rule);
    case 'selectors':
      return css.selectors.map(selector => parseCssObject(selector)).join('; ');
    default:
      throw new Error(`iOS Class Chain does not support '${css.type}' css. Only supports 'rule', 'ruleSet', 'selectors'`);
  }
}
CssConverter.toIosClassChainSelector = function toIosClassChainSelector(cssSelector) {
  let cssObj;
  try {
    cssObj = parser.parse(cssSelector);
  } catch (e) {
    throw new _driver.errors.InvalidSelectorError(`Invalid CSS selector '${cssSelector}'. Reason: '${e.message}'`);
  }
  try {
    return parseCssObject(cssObj);
  } catch (e) {
    throw new _driver.errors.InvalidSelectorError(`Unsupported CSS selector '${cssSelector}'. Reason: '${e.message}'`);
  }
};
var _default = CssConverter;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY3NzU2VsZWN0b3JQYXJzZXIiLCJyZXF1aXJlIiwiX2xvZGFzaCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfZHJpdmVyIiwiQ3NzQ29udmVydGVyIiwicGFyc2VyIiwiQ3NzU2VsZWN0b3JQYXJzZXIiLCJyZWdpc3RlclNlbGVjdG9yUHNldWRvcyIsInJlZ2lzdGVyTmVzdGluZ09wZXJhdG9ycyIsInJlZ2lzdGVyQXR0ckVxdWFsaXR5TW9kcyIsImVuYWJsZVN1YnN0aXR1dGVzIiwiQk9PTEVBTl9BVFRSUyIsIk5VTUVSSUNfQVRUUlMiLCJTVFJfQVRUUlMiLCJBTExfQVRUUlMiLCJBVFRSSUJVVEVfQUxJQVNFUyIsInRvQ2FtZWxDYXNlIiwic3RyIiwidG9rZW5zIiwic3BsaXQiLCJtYXAiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInNsaWNlIiwidG9Mb3dlckNhc2UiLCJvdXQiLCJqb2luIiwicmVxdWlyZUJvb2xlYW4iLCJjc3MiLCJfY3NzJHZhbHVlIiwidmFsIiwidmFsdWUiLCJUeXBlRXJyb3IiLCJuYW1lIiwicmVxdWlyZUF0dHJpYnV0ZU5hbWUiLCJhdHRyTmFtZSIsImluY2x1ZGVzIiwib2ZmaWNpYWxBdHRyIiwiYWxpYXNBdHRycyIsIkVycm9yIiwicGFyc2VBdHRyIiwiY3NzQXR0ciIsInZhbHVlVHlwZSIsImluZGV4Iiwib3BlcmF0b3IiLCJfIiwiZXNjYXBlUmVnRXhwIiwicGFyc2VQc2V1ZG8iLCJjc3NQc2V1ZG8iLCJwc2V1ZG9OYW1lIiwicGFyc2VDc3NSdWxlIiwiY3NzUnVsZSIsIm5lc3RpbmdPcGVyYXRvciIsImlvc0NsYXNzQ2hhaW5TZWxlY3RvciIsImNsYXNzTmFtZXMiLCJlcnJvcnMiLCJJbnZhbGlkU2VsZWN0b3JFcnJvciIsInRhZ05hbWUiLCJzdGFydHNXaXRoIiwiY2FwaXRhbGl6ZWRUYWdOYW1lIiwiYXR0cnMiLCJpZCIsInB1c2giLCJhdHRyIiwicHNldWRvcyIsInBzZXVkbyIsIm5vbkluZGV4QXR0cnMiLCJmaWx0ZXIiLCJpc1N0cmluZyIsImxlbmd0aCIsImluZGV4QXR0ciIsImZpbmQiLCJpc09iamVjdCIsInJ1bGUiLCJwYXJzZUNzc09iamVjdCIsInR5cGUiLCJzZWxlY3RvcnMiLCJzZWxlY3RvciIsInRvSW9zQ2xhc3NDaGFpblNlbGVjdG9yIiwiY3NzU2VsZWN0b3IiLCJjc3NPYmoiLCJwYXJzZSIsImUiLCJtZXNzYWdlIiwiX2RlZmF1bHQiLCJleHBvcnRzIiwiZGVmYXVsdCJdLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9jc3MtY29udmVydGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENzc1NlbGVjdG9yUGFyc2VyIH0gZnJvbSAnY3NzLXNlbGVjdG9yLXBhcnNlcic7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHsgZXJyb3JzIH0gZnJvbSAnYXBwaXVtL2RyaXZlcic7XG5cbmNvbnN0IENzc0NvbnZlcnRlciA9IHt9O1xuXG5jb25zdCBwYXJzZXIgPSBuZXcgQ3NzU2VsZWN0b3JQYXJzZXIoKTtcbnBhcnNlci5yZWdpc3RlclNlbGVjdG9yUHNldWRvcygnaGFzJyk7XG5wYXJzZXIucmVnaXN0ZXJOZXN0aW5nT3BlcmF0b3JzKCc+JywgJysnLCAnficpO1xucGFyc2VyLnJlZ2lzdGVyQXR0ckVxdWFsaXR5TW9kcygnXicsICckJywgJyonLCAnficpO1xucGFyc2VyLmVuYWJsZVN1YnN0aXR1dGVzKCk7XG5cbmNvbnN0IEJPT0xFQU5fQVRUUlMgPSBbXG4gICd2aXNpYmxlJywgJ2FjY2Vzc2libGUnLCAnYWNjZXNzaWJpbGl0eS1jb250YWluZXInLCAnZW5hYmxlZCcsXG5dO1xuXG5jb25zdCBOVU1FUklDX0FUVFJTID0gW1xuICAnaW5kZXgnXG5dO1xuXG5jb25zdCBTVFJfQVRUUlMgPSBbXG4gICdsYWJlbCcsICduYW1lJywgJ3ZhbHVlJywgJ3R5cGUnLFxuXTtcblxuY29uc3QgQUxMX0FUVFJTID0gW1xuICAuLi5CT09MRUFOX0FUVFJTLFxuICAuLi5OVU1FUklDX0FUVFJTLFxuICAuLi5TVFJfQVRUUlMsXG5dO1xuXG5jb25zdCBBVFRSSUJVVEVfQUxJQVNFUyA9IFtcbiAgWyduYW1lJywgWydpZCddXSxcbiAgWydpbmRleCcsIFsnbnRoLWNoaWxkJ11dLFxuXTtcblxuLyoqXG4gKiBDb252ZXJ0IGh5cGhlbiBzZXBhcmF0ZWQgd29yZCB0byBjYW1lbCBjYXNlXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxuICogQHJldHVybnMge3N0cmluZ30gVGhlIGh5cGhlbiBzZXBhcmF0ZWQgd29yZCB0cmFuc2xhdGVkIHRvIGNhbWVsIGNhc2VcbiAqL1xuZnVuY3Rpb24gdG9DYW1lbENhc2UgKHN0cikge1xuICBpZiAoIXN0cikge1xuICAgIHJldHVybiAnJztcbiAgfVxuICBjb25zdCB0b2tlbnMgPSBzdHIuc3BsaXQoJy0nKS5tYXAoKHN0cikgPT4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCkpO1xuICBjb25zdCBvdXQgPSB0b2tlbnMuam9pbignJyk7XG4gIHJldHVybiBvdXQuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkgKyBvdXQuc2xpY2UoMSk7XG59XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQ3NzTmFtZVZhbHVlT2JqZWN0XG4gKiBAcHJvcGVydHkgez9uYW1lfSBuYW1lIFRoZSBuYW1lIG9mIHRoZSBDU1Mgb2JqZWN0XG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IHZhbHVlIFRoZSB2YWx1ZSBvZiB0aGUgQ1NTIG9iamVjdFxuICovXG5cbi8qKlxuICogR2V0IHRoZSBib29sZWFuIGZyb20gYSBDU1Mgb2JqZWN0LiBJZiBlbXB0eSwgcmV0dXJuIHRydWUuIElmIG5vdCB0cnVlL2ZhbHNlL2VtcHR5LCB0aHJvdyBleGNlcHRpb25cbiAqXG4gKiBAcGFyYW0ge0Nzc05hbWVWYWx1ZU9iamVjdH0gY3NzIEEgQ1NTIG9iamVjdCB0aGF0IGhhcyAnbmFtZScgYW5kICd2YWx1ZSdcbiAqIEByZXR1cm5zIHtzdHJpbmd9IEVpdGhlciAndHJ1ZScgb3IgJ2ZhbHNlJy4gSWYgdmFsdWUgaXMgZW1wdHksIHJldHVybiAndHJ1ZSdcbiAqL1xuZnVuY3Rpb24gcmVxdWlyZUJvb2xlYW4gKGNzcykge1xuICBjb25zdCB2YWwgPSBjc3MudmFsdWU/LnRvTG93ZXJDYXNlKCkgfHwgJ3RydWUnOyAvLyBhbiBvbWl0dGVkIGJvb2xlYW4gYXR0cmlidXRlIG1lYW5zICd0cnVlJyAoZS5nLjogaW5wdXRbY2hlY2tlZF0gbWVhbnMgY2hlY2tlZCBpcyB0cnVlKVxuICBzd2l0Y2ggKHZhbCkge1xuICAgIGNhc2UgJzAnOlxuICAgIGNhc2UgJ2ZhbHNlJzpcbiAgICAgIHJldHVybiAnMCc7XG4gICAgY2FzZSAnMSc6XG4gICAgY2FzZSAndHJ1ZSc6XG4gICAgICByZXR1cm4gJzEnO1xuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGAnJHtjc3MubmFtZX0nIG11c3QgYmUgdHJ1ZSwgZmFsc2Ugb3IgZW1wdHkuIEZvdW5kICcke2Nzcy52YWx1ZX0nYCk7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgdGhlIGNhbm9uaWNhbCBmb3JtIG9mIGEgQ1NTIGF0dHJpYnV0ZSBuYW1lXG4gKlxuICogQ29udmVydHMgdG8gbG93ZXJjYXNlIGFuZCBpZiBhbiBhdHRyaWJ1dGUgbmFtZSBpcyBhbiBhbGlhcyBmb3Igc29tZXRoaW5nIGVsc2UsIHJldHVyblxuICogd2hhdCBpdCBpcyBhbiBhbGlhcyBmb3JcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gY3NzIENTUyBvYmplY3RcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBjYW5vbmljYWwgYXR0cmlidXRlIG5hbWVcbiAqL1xuZnVuY3Rpb24gcmVxdWlyZUF0dHJpYnV0ZU5hbWUgKGNzcykge1xuICBjb25zdCBhdHRyTmFtZSA9IGNzcy5uYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgLy8gQ2hlY2sgaWYgaXQncyBzdXBwb3J0ZWQgYW5kIGlmIGl0IGlzLCByZXR1cm4gaXRcbiAgaWYgKEFMTF9BVFRSUy5pbmNsdWRlcyhhdHRyTmFtZSkpIHtcbiAgICByZXR1cm4gYXR0ck5hbWUudG9Mb3dlckNhc2UoKTtcbiAgfVxuXG4gIC8vIElmIGF0dHJOYW1lIGlzIGFuIGFsaWFzIGZvciBzb21ldGhpbmcgZWxzZSwgcmV0dXJuIHRoYXRcbiAgZm9yIChjb25zdCBbb2ZmaWNpYWxBdHRyLCBhbGlhc0F0dHJzXSBvZiBBVFRSSUJVVEVfQUxJQVNFUykge1xuICAgIGlmIChhbGlhc0F0dHJzLmluY2x1ZGVzKGF0dHJOYW1lKSkge1xuICAgICAgcmV0dXJuIG9mZmljaWFsQXR0cjtcbiAgICB9XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKGAnJHthdHRyTmFtZX0nIGlzIG5vdCBhIHZhbGlkIGF0dHJpYnV0ZS4gYCArXG4gICAgYFN1cHBvcnRlZCBhdHRyaWJ1dGVzIGFyZSAnJHtBTExfQVRUUlMuam9pbignLCAnKX0nYCk7XG59XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQ3NzQXR0clxuICogQHByb3BlcnR5IHs/c3RyaW5nfSB2YWx1ZVR5cGUgVHlwZSBvZiBhdHRyaWJ1dGUgKG11c3QgYmUgc3RyaW5nIG9yIGVtcHR5KVxuICogQHByb3BlcnR5IHs/c3RyaW5nfSB2YWx1ZSBWYWx1ZSBvZiB0aGUgYXR0cmlidXRlXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IG9wZXJhdG9yIFRoZSBvcGVyYXRvciBiZXR3ZWVuIHZhbHVlIGFuZCB2YWx1ZSB0eXBlICg9LCAqPSwgLCBePSwgJD0pXG4gKi9cblxuLyoqXG4gKiBDb252ZXJ0IGEgQ1NTIGF0dHJpYnV0ZSBpbnRvIGEgVWlTZWxlY3RvciBtZXRob2QgY2FsbFxuICpcbiAqIEBwYXJhbSB7Q3NzQXR0cn0gY3NzQXR0ciBDU1MgYXR0cmlidXRlIG9iamVjdFxuICogQHJldHVybnMge3N0cmluZ30gQ1NTIGF0dHJpYnV0ZSBwYXJzZWQgYXMgVWlTZWxlY3RvclxuICovXG5mdW5jdGlvbiBwYXJzZUF0dHIgKGNzc0F0dHIpIHtcbiAgaWYgKGNzc0F0dHIudmFsdWVUeXBlICYmIGNzc0F0dHIudmFsdWVUeXBlICE9PSAnc3RyaW5nJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYCcke2Nzc0F0dHIubmFtZX09JHtjc3NBdHRyLnZhbHVlfScgaXMgYW4gaW52YWxpZCBhdHRyaWJ1dGUuIGAgK1xuICAgICAgYE9ubHkgJ3N0cmluZycgYW5kIGVtcHR5IGF0dHJpYnV0ZSB0eXBlcyBhcmUgc3VwcG9ydGVkLiBGb3VuZCAnJHtjc3NBdHRyLnZhbHVlVHlwZX0nYCk7XG4gIH1cbiAgY29uc3QgYXR0ck5hbWUgPSB0b0NhbWVsQ2FzZShyZXF1aXJlQXR0cmlidXRlTmFtZShjc3NBdHRyKSk7XG5cbiAgLy8gVmFsaWRhdGUgdGhhdCBpdCdzIGEgc3VwcG9ydGVkIGF0dHJpYnV0ZVxuICBpZiAoIVNUUl9BVFRSUy5pbmNsdWRlcyhhdHRyTmFtZSkgJiYgIUJPT0xFQU5fQVRUUlMuaW5jbHVkZXMoYXR0ck5hbWUpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGAnJHthdHRyTmFtZX0nIGlzIG5vdCBzdXBwb3J0ZWQuIFN1cHBvcnRlZCBhdHRyaWJ1dGVzIGFyZSBgICtcbiAgICAgIGAnJHtbLi4uU1RSX0FUVFJTLCAuLi5CT09MRUFOX0FUVFJTXS5qb2luKCcsICcpfSdgKTtcbiAgfVxuXG4gIC8vIFBhcnNlIGluZGV4IGlmIGl0J3MgYW4gaW5kZXggYXR0cmlidXRlXG4gIGlmIChhdHRyTmFtZSA9PT0gJ2luZGV4Jykge1xuICAgIHJldHVybiB7aW5kZXg6IGNzc0F0dHIudmFsdWV9O1xuICB9XG4gIGlmIChCT09MRUFOX0FUVFJTLmluY2x1ZGVzKGF0dHJOYW1lKSkge1xuICAgIHJldHVybiBgJHthdHRyTmFtZX0gPT0gJHtyZXF1aXJlQm9vbGVhbihjc3NBdHRyKX1gO1xuICB9XG5cbiAgbGV0IHZhbHVlID0gY3NzQXR0ci52YWx1ZSB8fCAnJztcbiAgaWYgKHZhbHVlID09PSAnJykge1xuICAgIHJldHVybiBgWyR7YXR0ck5hbWV9IExJS0UgJHt2YWx1ZX1dYDtcbiAgfVxuXG4gIHN3aXRjaCAoY3NzQXR0ci5vcGVyYXRvcikge1xuICAgIGNhc2UgJz0nOlxuICAgICAgcmV0dXJuIGAke2F0dHJOYW1lfSA9PSBcIiR7dmFsdWV9XCJgO1xuICAgIGNhc2UgJyo9JzpcbiAgICAgIHJldHVybiBgJHthdHRyTmFtZX0gTUFUQ0hFUyBcIiR7Xy5lc2NhcGVSZWdFeHAodmFsdWUpfVwiYDtcbiAgICBjYXNlICdePSc6XG4gICAgICByZXR1cm4gYCR7YXR0ck5hbWV9IEJFR0lOU1dJVEggXCIke3ZhbHVlfVwiYDtcbiAgICBjYXNlICckPSc6XG4gICAgICByZXR1cm4gYCR7YXR0ck5hbWV9IEVORFNXSVRIIFwiJHt2YWx1ZX1cImA7XG4gICAgY2FzZSAnfj0nOlxuICAgICAgcmV0dXJuIGAke2F0dHJOYW1lfSBDT05UQUlOUyBcIiR7dmFsdWV9XCJgO1xuICAgIGRlZmF1bHQ6XG4gICAgICAvLyBVbnJlYWNoYWJsZSwgYnV0IGFkZGluZyBlcnJvciBpbiBjYXNlIGEgbmV3IENTUyBhdHRyaWJ1dGUgaXMgYWRkZWQuXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIENTUyBhdHRyaWJ1dGUgb3BlcmF0b3IgJyR7Y3NzQXR0ci5vcGVyYXRvcn0nLiBgICtcbiAgICAgICAgYCAnPScsICcqPScsICdePScsICckPScgYW5kICd+PScgYXJlIHN1cHBvcnRlZC5gKTtcbiAgfVxufVxuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IENzc1BzZXVkb1xuICogQHByb3BlcnR5IHs/c3RyaW5nfSB2YWx1ZVR5cGUgVGhlIHR5cGUgb2YgQ1NTIHBzZXVkbyBzZWxlY3RvciAoaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvY3NzLXNlbGVjdG9yLXBhcnNlciBmb3IgcmVmZXJlbmNlKVxuICogQHByb3BlcnR5IHs/c3RyaW5nfSBuYW1lIFRoZSBuYW1lIG9mIHRoZSBwc2V1ZG8gc2VsZWN0b3JcbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gdmFsdWUgVGhlIHZhbHVlIG9mIHRoZSBwc2V1ZG8gc2VsZWN0b3JcbiAqL1xuXG4vKipcbiAqIENvbnZlcnQgYSBDU1MgcHNldWRvIGNsYXNzIHRvIGEgVWlTZWxlY3RvclxuICpcbiAqIEBwYXJhbSB7Q3NzUHNldWRvfSBjc3NQc2V1ZG8gQ1NTIFBzZXVkbyBjbGFzc1xuICogQHJldHVybnMge3N0cmluZ30gUHNldWRvIHNlbGVjdG9yIHBhcnNlZCBhcyBVaVNlbGVjdG9yXG4gKi9cbmZ1bmN0aW9uIHBhcnNlUHNldWRvIChjc3NQc2V1ZG8pIHtcbiAgaWYgKGNzc1BzZXVkby52YWx1ZVR5cGUgJiYgY3NzUHNldWRvLnZhbHVlVHlwZSAhPT0gJ3N0cmluZycpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYCcke2Nzc1BzZXVkby5uYW1lfT0ke2Nzc1BzZXVkby52YWx1ZX0nLiBgICtcbiAgICAgIGBVbnN1cHBvcnRlZCBjc3MgcHNldWRvIGNsYXNzIHZhbHVlIHR5cGU6ICcke2Nzc1BzZXVkby52YWx1ZVR5cGV9Jy4gT25seSAnc3RyaW5nJyB0eXBlIG9yIGVtcHR5IGlzIHN1cHBvcnRlZC5gKTtcbiAgfVxuXG4gIGNvbnN0IHBzZXVkb05hbWUgPSByZXF1aXJlQXR0cmlidXRlTmFtZShjc3NQc2V1ZG8pO1xuXG4gIGlmIChCT09MRUFOX0FUVFJTLmluY2x1ZGVzKHBzZXVkb05hbWUpKSB7XG4gICAgcmV0dXJuIGAke3RvQ2FtZWxDYXNlKHBzZXVkb05hbWUpfSA9PSAke3JlcXVpcmVCb29sZWFuKGNzc1BzZXVkbyl9YDtcbiAgfVxuXG4gIGlmIChwc2V1ZG9OYW1lID09PSAnaW5kZXgnKSB7XG4gICAgcmV0dXJuIHtpbmRleDogY3NzUHNldWRvLnZhbHVlfTtcbiAgfVxufVxuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IENzc1J1bGVcbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gbmVzdGluZ09wZXJhdG9yIFRoZSBuZXN0aW5nIG9wZXJhdG9yIChha2E6IGNvbWJpbmF0b3IgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL0NTU19TZWxlY3RvcnMpXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IHRhZ05hbWUgVGhlIHRhZyBuYW1lIChha2E6IHR5cGUgc2VsZWN0b3IgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL1R5cGVfc2VsZWN0b3JzKVxuICogQHByb3BlcnR5IHs/c3RyaW5nW119IGNsYXNzTmFtZXMgQW4gYXJyYXkgb2YgQ1NTIGNsYXNzIG5hbWVzXG4gKiBAcHJvcGVydHkgez9Dc3NBdHRyW119IGF0dHJzIEFuIGFycmF5IG9mIENTUyBhdHRyaWJ1dGVzXG4gKiBAcHJvcGVydHkgez9Dc3NQc2V1ZG9bXX0gYXR0cnMgQW4gYXJyYXkgb2YgQ1NTIHBzZXVkb3NcbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gaWQgQ1NTIGlkZW50aWZpZXJcbiAqIEBwcm9wZXJ0eSB7P0Nzc1J1bGV9IHJ1bGUgQSBkZXNjZW5kYW50IG9mIHRoaXMgQ1NTIHJ1bGVcbiAqL1xuXG4vKipcbiAqIENvbnZlcnQgYSBDU1MgcnVsZSB0byBhIFVpU2VsZWN0b3JcbiAqIEBwYXJhbSB7Q3NzUnVsZX0gY3NzUnVsZSBDU1MgcnVsZSBkZWZpbml0aW9uXG4gKi9cbmZ1bmN0aW9uIHBhcnNlQ3NzUnVsZSAoY3NzUnVsZSkge1xuICBjb25zdCB7IG5lc3RpbmdPcGVyYXRvciB9ID0gY3NzUnVsZTtcbiAgaWYgKG5lc3RpbmdPcGVyYXRvciAmJiBuZXN0aW5nT3BlcmF0b3IgIT09ICcgJyAmJiBuZXN0aW5nT3BlcmF0b3IgIT09ICc+Jykge1xuICAgIHRocm93IG5ldyBFcnJvcihgJyR7bmVzdGluZ09wZXJhdG9yfScgaXMgbm90IGEgc3VwcG9ydGVkIGNvbWJpbmF0b3IuIGAgK1xuICAgICAgYE9ubHkgY2hpbGQgY29tYmluYXRvciAoPikgYW5kIGRlc2NlbmRhbnQgY29tYmluYXRvciBhcmUgc3VwcG9ydGVkLmApO1xuICB9XG5cbiAgbGV0IGlvc0NsYXNzQ2hhaW5TZWxlY3RvciA9ICcnO1xuICBpZiAoY3NzUnVsZS5jbGFzc05hbWVzKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5JbnZhbGlkU2VsZWN0b3JFcnJvcihgJyR7W2Nzc1J1bGUgfHwgJycsIC4uLmNzc1J1bGUuY2xhc3NOYW1lc10uam9pbignLicpfSdcbiAgICAgIGlzIG5vdCBhIHZhbGlkIGlvcyBjbGFzcy4gTXVzdCBiZSBhIHNpbmdsZSBzdHJpbmcgKGUuZy46IFhDVUlFbGVtZW50VHlwZVdpbmRvdykgd2l0aG91dFxuICAgICAgZG90cyBzZXBhcmF0aW5nIHRoZW1gKTtcbiAgfVxuICBpZiAoY3NzUnVsZS50YWdOYW1lICYmIGNzc1J1bGUudGFnTmFtZSAhPT0gJyonICYmICFjc3NSdWxlLnRhZ05hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCd4Y3VpZWxlbWVudHR5cGUnKSkge1xuICAgIGNvbnN0IGNhcGl0YWxpemVkVGFnTmFtZSA9IGNzc1J1bGUudGFnTmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGNzc1J1bGUudGFnTmFtZS5zbGljZSgxKTtcbiAgICBjc3NSdWxlLnRhZ05hbWUgPSBgWENVSUVsZW1lbnRUeXBlJHtjYXBpdGFsaXplZFRhZ05hbWV9YDtcbiAgfVxuICBpb3NDbGFzc0NoYWluU2VsZWN0b3IgKz0gKGNzc1J1bGUudGFnTmFtZSB8fCAnKicpO1xuXG4gIGxldCBhdHRycyA9IFtdO1xuICBpZiAoY3NzUnVsZS5pZCkge1xuICAgIGF0dHJzLnB1c2goYG5hbWUgPT0gXCIke2Nzc1J1bGUuaWR9XCJgKTtcbiAgfVxuICBpZiAoY3NzUnVsZS5hdHRycykge1xuICAgIGZvciAoY29uc3QgYXR0ciBvZiBjc3NSdWxlLmF0dHJzKSB7XG4gICAgICBhdHRycy5wdXNoKHBhcnNlQXR0cihhdHRyKSk7XG4gICAgfVxuICB9XG4gIGlmIChjc3NSdWxlLnBzZXVkb3MpIHtcbiAgICBmb3IgKGNvbnN0IHBzZXVkbyBvZiBjc3NSdWxlLnBzZXVkb3MpIHtcbiAgICAgIGF0dHJzLnB1c2gocGFyc2VQc2V1ZG8ocHNldWRvKSk7XG4gICAgfVxuICB9XG4gIGNvbnN0IG5vbkluZGV4QXR0cnMgPSBhdHRycy5maWx0ZXIoKGF0dHIpID0+IF8uaXNTdHJpbmcoYXR0cikpO1xuICBpZiAobm9uSW5kZXhBdHRycyAmJiBub25JbmRleEF0dHJzLmxlbmd0aCA+IDApIHtcbiAgICBpb3NDbGFzc0NoYWluU2VsZWN0b3IgKz0gYFtcXGAke25vbkluZGV4QXR0cnMuam9pbignIEFORCAnKX1cXGBdYDtcbiAgfVxuXG4gIGNvbnN0IGluZGV4QXR0ciA9IGF0dHJzLmZpbmQoKGF0dHIpID0+IF8uaXNPYmplY3QoYXR0cikgJiYgYXR0ci5pbmRleCk7XG4gIGlmIChpbmRleEF0dHIpIHtcbiAgICBpb3NDbGFzc0NoYWluU2VsZWN0b3IgKz0gYFske2luZGV4QXR0ci5pbmRleH1dYDtcbiAgfVxuXG4gIGlmIChjc3NSdWxlLnJ1bGUpIHtcbiAgICBpb3NDbGFzc0NoYWluU2VsZWN0b3IgKz0gYC8ke3BhcnNlQ3NzUnVsZShjc3NSdWxlLnJ1bGUpfWA7XG4gIH1cblxuICBpZiAoY3NzUnVsZS5uZXN0aW5nT3BlcmF0b3IgPT09ICc+Jykge1xuICAgIHJldHVybiBpb3NDbGFzc0NoYWluU2VsZWN0b3I7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGAqKi9gICsgaW9zQ2xhc3NDaGFpblNlbGVjdG9yO1xuICB9XG59XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQ3NzT2JqZWN0XG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IHR5cGUgVHlwZSBvZiBDU1Mgb2JqZWN0LiAncnVsZScsICdydWxlc2V0JyBvciAnc2VsZWN0b3JzJ1xuICovXG5cbi8qKlxuICogQ29udmVydCBDU1Mgb2JqZWN0IHRvIGlPUyBDbGFzcyBDaGFpbiBzZWxlY3RvclxuICogQHBhcmFtIHtDc3NPYmplY3R9IGNzcyBDU1Mgb2JqZWN0XG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgQ1NTIG9iamVjdCBwYXJzZWQgYXMgYSBVaVNlbGVjdG9yXG4gKi9cbmZ1bmN0aW9uIHBhcnNlQ3NzT2JqZWN0IChjc3MpIHtcbiAgc3dpdGNoIChjc3MudHlwZSkge1xuICAgIGNhc2UgJ3J1bGUnOlxuICAgICAgcmV0dXJuIHBhcnNlQ3NzUnVsZShjc3MpO1xuICAgIGNhc2UgJ3J1bGVTZXQnOlxuICAgICAgcmV0dXJuIHBhcnNlQ3NzT2JqZWN0KGNzcy5ydWxlKTtcbiAgICBjYXNlICdzZWxlY3RvcnMnOlxuICAgICAgcmV0dXJuIGNzcy5zZWxlY3RvcnMubWFwKChzZWxlY3RvcikgPT4gcGFyc2VDc3NPYmplY3Qoc2VsZWN0b3IpKS5qb2luKCc7ICcpO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIC8vIFRoaXMgaXMgbmV2ZXIgcmVhY2hhYmxlLCBidXQgaWYgaXQgZXZlciBpcyBkbyB0aGlzLlxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBpT1MgQ2xhc3MgQ2hhaW4gZG9lcyBub3Qgc3VwcG9ydCAnJHtjc3MudHlwZX0nIGNzcy4gT25seSBzdXBwb3J0cyAncnVsZScsICdydWxlU2V0JywgJ3NlbGVjdG9ycydgKTtcbiAgfVxufVxuXG4vKipcbiAqIENvbnZlcnQgYSBDU1Mgc2VsZWN0b3IgdG8gYSBpT1MgQ2xhc3MgQ2hhaW4gc2VsZWN0b3JcbiAqIEBwYXJhbSB7c3RyaW5nfSBjc3NTZWxlY3RvciBDU1MgU2VsZWN0b3JcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBDU1Mgc2VsZWN0b3IgY29udmVydGVkIHRvIGFuIGlPUyBDbGFzcyBDaGFpblxuICovXG5Dc3NDb252ZXJ0ZXIudG9Jb3NDbGFzc0NoYWluU2VsZWN0b3IgPSBmdW5jdGlvbiB0b0lvc0NsYXNzQ2hhaW5TZWxlY3RvciAoY3NzU2VsZWN0b3IpIHtcbiAgbGV0IGNzc09iajtcbiAgdHJ5IHtcbiAgICBjc3NPYmogPSBwYXJzZXIucGFyc2UoY3NzU2VsZWN0b3IpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5JbnZhbGlkU2VsZWN0b3JFcnJvcihgSW52YWxpZCBDU1Mgc2VsZWN0b3IgJyR7Y3NzU2VsZWN0b3J9Jy4gUmVhc29uOiAnJHtlLm1lc3NhZ2V9J2ApO1xuICB9XG4gIHRyeSB7XG4gICAgcmV0dXJuIHBhcnNlQ3NzT2JqZWN0KGNzc09iaik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLkludmFsaWRTZWxlY3RvckVycm9yKGBVbnN1cHBvcnRlZCBDU1Mgc2VsZWN0b3IgJyR7Y3NzU2VsZWN0b3J9Jy4gUmVhc29uOiAnJHtlLm1lc3NhZ2V9J2ApO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBDc3NDb252ZXJ0ZXI7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLElBQUFBLGtCQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxPQUFBLEdBQUFDLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBRyxPQUFBLEdBQUFILE9BQUE7QUFFQSxNQUFNSSxZQUFZLEdBQUcsQ0FBQyxDQUFDO0FBRXZCLE1BQU1DLE1BQU0sR0FBRyxJQUFJQyxvQ0FBaUIsRUFBRTtBQUN0Q0QsTUFBTSxDQUFDRSx1QkFBdUIsQ0FBQyxLQUFLLENBQUM7QUFDckNGLE1BQU0sQ0FBQ0csd0JBQXdCLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7QUFDOUNILE1BQU0sQ0FBQ0ksd0JBQXdCLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO0FBQ25ESixNQUFNLENBQUNLLGlCQUFpQixFQUFFO0FBRTFCLE1BQU1DLGFBQWEsR0FBRyxDQUNwQixTQUFTLEVBQUUsWUFBWSxFQUFFLHlCQUF5QixFQUFFLFNBQVMsQ0FDOUQ7QUFFRCxNQUFNQyxhQUFhLEdBQUcsQ0FDcEIsT0FBTyxDQUNSO0FBRUQsTUFBTUMsU0FBUyxHQUFHLENBQ2hCLE9BQU8sRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLE1BQU0sQ0FDakM7QUFFRCxNQUFNQyxTQUFTLEdBQUcsQ0FDaEIsR0FBR0gsYUFBYSxFQUNoQixHQUFHQyxhQUFhLEVBQ2hCLEdBQUdDLFNBQVMsQ0FDYjtBQUVELE1BQU1FLGlCQUFpQixHQUFHLENBQ3hCLENBQUMsTUFBTSxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsRUFDaEIsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUN6QjtBQVFELFNBQVNDLFdBQVdBLENBQUVDLEdBQUcsRUFBRTtFQUN6QixJQUFJLENBQUNBLEdBQUcsRUFBRTtJQUNSLE9BQU8sRUFBRTtFQUNYO0VBQ0EsTUFBTUMsTUFBTSxHQUFHRCxHQUFHLENBQUNFLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsR0FBRyxDQUFFSCxHQUFHLElBQUtBLEdBQUcsQ0FBQ0ksTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDQyxXQUFXLEVBQUUsR0FBR0wsR0FBRyxDQUFDTSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUNDLFdBQVcsRUFBRSxDQUFDO0VBQ3BHLE1BQU1DLEdBQUcsR0FBR1AsTUFBTSxDQUFDUSxJQUFJLENBQUMsRUFBRSxDQUFDO0VBQzNCLE9BQU9ELEdBQUcsQ0FBQ0osTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDRyxXQUFXLEVBQUUsR0FBR0MsR0FBRyxDQUFDRixLQUFLLENBQUMsQ0FBQyxDQUFDO0FBQ25EO0FBY0EsU0FBU0ksY0FBY0EsQ0FBRUMsR0FBRyxFQUFFO0VBQUEsSUFBQUMsVUFBQTtFQUM1QixNQUFNQyxHQUFHLEdBQUcsRUFBQUQsVUFBQSxHQUFBRCxHQUFHLENBQUNHLEtBQUssY0FBQUYsVUFBQSx1QkFBVEEsVUFBQSxDQUFXTCxXQUFXLEVBQUUsS0FBSSxNQUFNO0VBQzlDLFFBQVFNLEdBQUc7SUFDVCxLQUFLLEdBQUc7SUFDUixLQUFLLE9BQU87TUFDVixPQUFPLEdBQUc7SUFDWixLQUFLLEdBQUc7SUFDUixLQUFLLE1BQU07TUFDVCxPQUFPLEdBQUc7SUFDWjtNQUNFLE1BQU0sSUFBSUUsU0FBUyxDQUFFLElBQUdKLEdBQUcsQ0FBQ0ssSUFBSywwQ0FBeUNMLEdBQUcsQ0FBQ0csS0FBTSxHQUFFLENBQUM7RUFBQztBQUU5RjtBQVdBLFNBQVNHLG9CQUFvQkEsQ0FBRU4sR0FBRyxFQUFFO0VBQ2xDLE1BQU1PLFFBQVEsR0FBR1AsR0FBRyxDQUFDSyxJQUFJLENBQUNULFdBQVcsRUFBRTtFQUd2QyxJQUFJVixTQUFTLENBQUNzQixRQUFRLENBQUNELFFBQVEsQ0FBQyxFQUFFO0lBQ2hDLE9BQU9BLFFBQVEsQ0FBQ1gsV0FBVyxFQUFFO0VBQy9CO0VBR0EsS0FBSyxNQUFNLENBQUNhLFlBQVksRUFBRUMsVUFBVSxDQUFDLElBQUl2QixpQkFBaUIsRUFBRTtJQUMxRCxJQUFJdUIsVUFBVSxDQUFDRixRQUFRLENBQUNELFFBQVEsQ0FBQyxFQUFFO01BQ2pDLE9BQU9FLFlBQVk7SUFDckI7RUFDRjtFQUNBLE1BQU0sSUFBSUUsS0FBSyxDQUFFLElBQUdKLFFBQVMsOEJBQTZCLEdBQ3ZELDZCQUE0QnJCLFNBQVMsQ0FBQ1ksSUFBSSxDQUFDLElBQUksQ0FBRSxHQUFFLENBQUM7QUFDekQ7QUFlQSxTQUFTYyxTQUFTQSxDQUFFQyxPQUFPLEVBQUU7RUFDM0IsSUFBSUEsT0FBTyxDQUFDQyxTQUFTLElBQUlELE9BQU8sQ0FBQ0MsU0FBUyxLQUFLLFFBQVEsRUFBRTtJQUN2RCxNQUFNLElBQUlWLFNBQVMsQ0FBRSxJQUFHUyxPQUFPLENBQUNSLElBQUssSUFBR1EsT0FBTyxDQUFDVixLQUFNLDZCQUE0QixHQUMvRSxpRUFBZ0VVLE9BQU8sQ0FBQ0MsU0FBVSxHQUFFLENBQUM7RUFDMUY7RUFDQSxNQUFNUCxRQUFRLEdBQUduQixXQUFXLENBQUNrQixvQkFBb0IsQ0FBQ08sT0FBTyxDQUFDLENBQUM7RUFHM0QsSUFBSSxDQUFDNUIsU0FBUyxDQUFDdUIsUUFBUSxDQUFDRCxRQUFRLENBQUMsSUFBSSxDQUFDeEIsYUFBYSxDQUFDeUIsUUFBUSxDQUFDRCxRQUFRLENBQUMsRUFBRTtJQUN0RSxNQUFNLElBQUlJLEtBQUssQ0FBRSxJQUFHSixRQUFTLCtDQUE4QyxHQUN4RSxJQUFHLENBQUMsR0FBR3RCLFNBQVMsRUFBRSxHQUFHRixhQUFhLENBQUMsQ0FBQ2UsSUFBSSxDQUFDLElBQUksQ0FBRSxHQUFFLENBQUM7RUFDdkQ7RUFHQSxJQUFJUyxRQUFRLEtBQUssT0FBTyxFQUFFO0lBQ3hCLE9BQU87TUFBQ1EsS0FBSyxFQUFFRixPQUFPLENBQUNWO0lBQUssQ0FBQztFQUMvQjtFQUNBLElBQUlwQixhQUFhLENBQUN5QixRQUFRLENBQUNELFFBQVEsQ0FBQyxFQUFFO0lBQ3BDLE9BQVEsR0FBRUEsUUFBUyxPQUFNUixjQUFjLENBQUNjLE9BQU8sQ0FBRSxFQUFDO0VBQ3BEO0VBRUEsSUFBSVYsS0FBSyxHQUFHVSxPQUFPLENBQUNWLEtBQUssSUFBSSxFQUFFO0VBQy9CLElBQUlBLEtBQUssS0FBSyxFQUFFLEVBQUU7SUFDaEIsT0FBUSxJQUFHSSxRQUFTLFNBQVFKLEtBQU0sR0FBRTtFQUN0QztFQUVBLFFBQVFVLE9BQU8sQ0FBQ0csUUFBUTtJQUN0QixLQUFLLEdBQUc7TUFDTixPQUFRLEdBQUVULFFBQVMsUUFBT0osS0FBTSxHQUFFO0lBQ3BDLEtBQUssSUFBSTtNQUNQLE9BQVEsR0FBRUksUUFBUyxhQUFZVSxlQUFDLENBQUNDLFlBQVksQ0FBQ2YsS0FBSyxDQUFFLEdBQUU7SUFDekQsS0FBSyxJQUFJO01BQ1AsT0FBUSxHQUFFSSxRQUFTLGdCQUFlSixLQUFNLEdBQUU7SUFDNUMsS0FBSyxJQUFJO01BQ1AsT0FBUSxHQUFFSSxRQUFTLGNBQWFKLEtBQU0sR0FBRTtJQUMxQyxLQUFLLElBQUk7TUFDUCxPQUFRLEdBQUVJLFFBQVMsY0FBYUosS0FBTSxHQUFFO0lBQzFDO01BRUUsTUFBTSxJQUFJUSxLQUFLLENBQUUsdUNBQXNDRSxPQUFPLENBQUNHLFFBQVMsS0FBSSxHQUN6RSxnREFBK0MsQ0FBQztFQUFDO0FBRTFEO0FBZUEsU0FBU0csV0FBV0EsQ0FBRUMsU0FBUyxFQUFFO0VBQy9CLElBQUlBLFNBQVMsQ0FBQ04sU0FBUyxJQUFJTSxTQUFTLENBQUNOLFNBQVMsS0FBSyxRQUFRLEVBQUU7SUFDM0QsTUFBTSxJQUFJSCxLQUFLLENBQUUsSUFBR1MsU0FBUyxDQUFDZixJQUFLLElBQUdlLFNBQVMsQ0FBQ2pCLEtBQU0sS0FBSSxHQUN2RCw2Q0FBNENpQixTQUFTLENBQUNOLFNBQVUsOENBQTZDLENBQUM7RUFDbkg7RUFFQSxNQUFNTyxVQUFVLEdBQUdmLG9CQUFvQixDQUFDYyxTQUFTLENBQUM7RUFFbEQsSUFBSXJDLGFBQWEsQ0FBQ3lCLFFBQVEsQ0FBQ2EsVUFBVSxDQUFDLEVBQUU7SUFDdEMsT0FBUSxHQUFFakMsV0FBVyxDQUFDaUMsVUFBVSxDQUFFLE9BQU10QixjQUFjLENBQUNxQixTQUFTLENBQUUsRUFBQztFQUNyRTtFQUVBLElBQUlDLFVBQVUsS0FBSyxPQUFPLEVBQUU7SUFDMUIsT0FBTztNQUFDTixLQUFLLEVBQUVLLFNBQVMsQ0FBQ2pCO0lBQUssQ0FBQztFQUNqQztBQUNGO0FBaUJBLFNBQVNtQixZQUFZQSxDQUFFQyxPQUFPLEVBQUU7RUFDOUIsTUFBTTtJQUFFQztFQUFnQixDQUFDLEdBQUdELE9BQU87RUFDbkMsSUFBSUMsZUFBZSxJQUFJQSxlQUFlLEtBQUssR0FBRyxJQUFJQSxlQUFlLEtBQUssR0FBRyxFQUFFO0lBQ3pFLE1BQU0sSUFBSWIsS0FBSyxDQUFFLElBQUdhLGVBQWdCLG1DQUFrQyxHQUNuRSxvRUFBbUUsQ0FBQztFQUN6RTtFQUVBLElBQUlDLHFCQUFxQixHQUFHLEVBQUU7RUFDOUIsSUFBSUYsT0FBTyxDQUFDRyxVQUFVLEVBQUU7SUFDdEIsTUFBTSxJQUFJQyxjQUFNLENBQUNDLG9CQUFvQixDQUFFLElBQUcsQ0FBQ0wsT0FBTyxJQUFJLEVBQUUsRUFBRSxHQUFHQSxPQUFPLENBQUNHLFVBQVUsQ0FBQyxDQUFDNUIsSUFBSSxDQUFDLEdBQUcsQ0FBRTtBQUMvRjtBQUNBLDJCQUEyQixDQUFDO0VBQzFCO0VBQ0EsSUFBSXlCLE9BQU8sQ0FBQ00sT0FBTyxJQUFJTixPQUFPLENBQUNNLE9BQU8sS0FBSyxHQUFHLElBQUksQ0FBQ04sT0FBTyxDQUFDTSxPQUFPLENBQUNqQyxXQUFXLEVBQUUsQ0FBQ2tDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFO0lBQzlHLE1BQU1DLGtCQUFrQixHQUFHUixPQUFPLENBQUNNLE9BQU8sQ0FBQ3BDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQ0MsV0FBVyxFQUFFLEdBQUc2QixPQUFPLENBQUNNLE9BQU8sQ0FBQ2xDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDN0Y0QixPQUFPLENBQUNNLE9BQU8sR0FBSSxrQkFBaUJFLGtCQUFtQixFQUFDO0VBQzFEO0VBQ0FOLHFCQUFxQixJQUFLRixPQUFPLENBQUNNLE9BQU8sSUFBSSxHQUFJO0VBRWpELElBQUlHLEtBQUssR0FBRyxFQUFFO0VBQ2QsSUFBSVQsT0FBTyxDQUFDVSxFQUFFLEVBQUU7SUFDZEQsS0FBSyxDQUFDRSxJQUFJLENBQUUsWUFBV1gsT0FBTyxDQUFDVSxFQUFHLEdBQUUsQ0FBQztFQUN2QztFQUNBLElBQUlWLE9BQU8sQ0FBQ1MsS0FBSyxFQUFFO0lBQ2pCLEtBQUssTUFBTUcsSUFBSSxJQUFJWixPQUFPLENBQUNTLEtBQUssRUFBRTtNQUNoQ0EsS0FBSyxDQUFDRSxJQUFJLENBQUN0QixTQUFTLENBQUN1QixJQUFJLENBQUMsQ0FBQztJQUM3QjtFQUNGO0VBQ0EsSUFBSVosT0FBTyxDQUFDYSxPQUFPLEVBQUU7SUFDbkIsS0FBSyxNQUFNQyxNQUFNLElBQUlkLE9BQU8sQ0FBQ2EsT0FBTyxFQUFFO01BQ3BDSixLQUFLLENBQUNFLElBQUksQ0FBQ2YsV0FBVyxDQUFDa0IsTUFBTSxDQUFDLENBQUM7SUFDakM7RUFDRjtFQUNBLE1BQU1DLGFBQWEsR0FBR04sS0FBSyxDQUFDTyxNQUFNLENBQUVKLElBQUksSUFBS2xCLGVBQUMsQ0FBQ3VCLFFBQVEsQ0FBQ0wsSUFBSSxDQUFDLENBQUM7RUFDOUQsSUFBSUcsYUFBYSxJQUFJQSxhQUFhLENBQUNHLE1BQU0sR0FBRyxDQUFDLEVBQUU7SUFDN0NoQixxQkFBcUIsSUFBSyxNQUFLYSxhQUFhLENBQUN4QyxJQUFJLENBQUMsT0FBTyxDQUFFLEtBQUk7RUFDakU7RUFFQSxNQUFNNEMsU0FBUyxHQUFHVixLQUFLLENBQUNXLElBQUksQ0FBRVIsSUFBSSxJQUFLbEIsZUFBQyxDQUFDMkIsUUFBUSxDQUFDVCxJQUFJLENBQUMsSUFBSUEsSUFBSSxDQUFDcEIsS0FBSyxDQUFDO0VBQ3RFLElBQUkyQixTQUFTLEVBQUU7SUFDYmpCLHFCQUFxQixJQUFLLElBQUdpQixTQUFTLENBQUMzQixLQUFNLEdBQUU7RUFDakQ7RUFFQSxJQUFJUSxPQUFPLENBQUNzQixJQUFJLEVBQUU7SUFDaEJwQixxQkFBcUIsSUFBSyxJQUFHSCxZQUFZLENBQUNDLE9BQU8sQ0FBQ3NCLElBQUksQ0FBRSxFQUFDO0VBQzNEO0VBRUEsSUFBSXRCLE9BQU8sQ0FBQ0MsZUFBZSxLQUFLLEdBQUcsRUFBRTtJQUNuQyxPQUFPQyxxQkFBcUI7RUFDOUIsQ0FBQyxNQUFNO0lBQ0wsT0FBUSxLQUFJLEdBQUdBLHFCQUFxQjtFQUN0QztBQUNGO0FBWUEsU0FBU3FCLGNBQWNBLENBQUU5QyxHQUFHLEVBQUU7RUFDNUIsUUFBUUEsR0FBRyxDQUFDK0MsSUFBSTtJQUNkLEtBQUssTUFBTTtNQUNULE9BQU96QixZQUFZLENBQUN0QixHQUFHLENBQUM7SUFDMUIsS0FBSyxTQUFTO01BQ1osT0FBTzhDLGNBQWMsQ0FBQzlDLEdBQUcsQ0FBQzZDLElBQUksQ0FBQztJQUNqQyxLQUFLLFdBQVc7TUFDZCxPQUFPN0MsR0FBRyxDQUFDZ0QsU0FBUyxDQUFDeEQsR0FBRyxDQUFFeUQsUUFBUSxJQUFLSCxjQUFjLENBQUNHLFFBQVEsQ0FBQyxDQUFDLENBQUNuRCxJQUFJLENBQUMsSUFBSSxDQUFDO0lBRTdFO01BRUUsTUFBTSxJQUFJYSxLQUFLLENBQUUscUNBQW9DWCxHQUFHLENBQUMrQyxJQUFLLHFEQUFvRCxDQUFDO0VBQUM7QUFFMUg7QUFPQXZFLFlBQVksQ0FBQzBFLHVCQUF1QixHQUFHLFNBQVNBLHVCQUF1QkEsQ0FBRUMsV0FBVyxFQUFFO0VBQ3BGLElBQUlDLE1BQU07RUFDVixJQUFJO0lBQ0ZBLE1BQU0sR0FBRzNFLE1BQU0sQ0FBQzRFLEtBQUssQ0FBQ0YsV0FBVyxDQUFDO0VBQ3BDLENBQUMsQ0FBQyxPQUFPRyxDQUFDLEVBQUU7SUFDVixNQUFNLElBQUkzQixjQUFNLENBQUNDLG9CQUFvQixDQUFFLHlCQUF3QnVCLFdBQVksZUFBY0csQ0FBQyxDQUFDQyxPQUFRLEdBQUUsQ0FBQztFQUN4RztFQUNBLElBQUk7SUFDRixPQUFPVCxjQUFjLENBQUNNLE1BQU0sQ0FBQztFQUMvQixDQUFDLENBQUMsT0FBT0UsQ0FBQyxFQUFFO0lBQ1YsTUFBTSxJQUFJM0IsY0FBTSxDQUFDQyxvQkFBb0IsQ0FBRSw2QkFBNEJ1QixXQUFZLGVBQWNHLENBQUMsQ0FBQ0MsT0FBUSxHQUFFLENBQUM7RUFDNUc7QUFDRixDQUFDO0FBQUMsSUFBQUMsUUFBQSxHQUVhaEYsWUFBWTtBQUFBaUYsT0FBQSxDQUFBQyxPQUFBLEdBQUFGLFFBQUEifQ==