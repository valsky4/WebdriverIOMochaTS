"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.IOSCrashLog = void 0;
require("source-map-support/register");
var _support = require("appium/support");
var _bluebird = _interopRequireDefault(require("bluebird"));
var _logger = _interopRequireDefault(require("../logger"));
var _appiumIosDevice = require("appium-ios-device");
var _path = _interopRequireDefault(require("path"));
var _lodash = _interopRequireDefault(require("lodash"));
var _pyIosDeviceClient = _interopRequireDefault(require("../py-ios-device-client"));
const REAL_DEVICE_MAGIC = '3620bbb0-fb9f-4b62-a668-896f2edc4d88';
const MAGIC_SEP = '/';
class IOSCrashLog {
  constructor(opts = {}) {
    this.udid = opts.udid;
    this.pyideviceClient = this.udid ? new _pyIosDeviceClient.default(this.udid) : null;
    const logDir = opts.udid ? _path.default.resolve(process.env.HOME, 'Library', 'Logs', 'CrashReporter', 'MobileDevice') : _path.default.resolve(process.env.HOME, 'Library', 'Logs', 'DiagnosticReports');
    this.logDir = logDir || _path.default.resolve(process.env.HOME || '/', 'Library', 'Logs', 'DiagnosticReports');
    this.prevLogs = [];
    this.logsSinceLastRequest = [];
    this.phoneName = null;
    this.sim = opts.sim;
  }
  async _gatherFromRealDevice() {
    if (await this.pyideviceClient.assertExists(false)) {
      return (await this.pyideviceClient.listCrashes()).map(x => `${REAL_DEVICE_MAGIC}${MAGIC_SEP}${x}`);
    }
    let crashLogsRoot = this.logDir;
    if (this.udid) {
      this.phoneName = this.phoneName || (await _appiumIosDevice.utilities.getDeviceName(this.udid));
      crashLogsRoot = _path.default.resolve(crashLogsRoot, this.phoneName);
    }
    if (!(await _support.fs.exists(crashLogsRoot))) {
      _logger.default.debug(`Crash reports root '${crashLogsRoot}' does not exist. Got nothing to gather.`);
      return [];
    }
    const foundFiles = await _support.fs.glob(`${crashLogsRoot}/**/*.crash`, {
      strict: false
    });
    return foundFiles;
  }
  async _gatherFromSimulator() {
    if (!(await _support.fs.exists(this.logDir))) {
      _logger.default.debug(`Crash reports root '${this.logDir}' does not exist. Got nothing to gather.`);
      return [];
    }
    const foundFiles = await _support.fs.glob(`${this.logDir}/**/*.+(crash|ips)`, {
      strict: false
    });
    return await _bluebird.default.filter(foundFiles, async x => {
      try {
        const content = await _support.fs.readFile(x, 'utf8');
        return content.toUpperCase().includes(this.sim.udid.toUpperCase());
      } catch (err) {
        return false;
      }
    });
  }
  async getCrashes() {
    return this.udid ? await this._gatherFromRealDevice() : await this._gatherFromSimulator();
  }
  async startCapture() {
    this.prevLogs = await this.getCrashes();
  }
  async stopCapture() {}
  async getLogs() {
    let crashFiles = await this.getCrashes();
    let diff = _lodash.default.difference(crashFiles, this.prevLogs, this.logsSinceLastRequest);
    this.logsSinceLastRequest = _lodash.default.union(this.logsSinceLastRequest, diff);
    return await this.filesToJSON(diff);
  }
  async getAllLogs() {
    let crashFiles = await this.getCrashes();
    let logFiles = _lodash.default.difference(crashFiles, this.prevLogs);
    return await this.filesToJSON(logFiles);
  }
  async filesToJSON(paths) {
    const tmpRoot = await _support.tempDir.openDir();
    try {
      return (await _bluebird.default.map(paths, async fullPath => {
        if (_lodash.default.includes(fullPath, REAL_DEVICE_MAGIC)) {
          const fileName = _lodash.default.last(fullPath.split(MAGIC_SEP));
          try {
            await this.pyideviceClient.exportCrash(fileName, tmpRoot);
          } catch (e) {
            _logger.default.warn(`Cannot export the crash report '${fileName}'. Skipping it. ` + `Original error: ${e.message}`);
            return;
          }
          fullPath = _path.default.join(tmpRoot, fileName);
        }
        const stat = await _support.fs.stat(fullPath);
        return {
          timestamp: stat.ctime.getTime(),
          level: 'ALL',
          message: await _support.fs.readFile(fullPath, 'utf8')
        };
      })).filter(Boolean);
    } finally {
      await _support.fs.rimraf(tmpRoot);
    }
  }
}
exports.IOSCrashLog = IOSCrashLog;
var _default = IOSCrashLog;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfc3VwcG9ydCIsInJlcXVpcmUiLCJfYmx1ZWJpcmQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX2xvZ2dlciIsIl9hcHBpdW1Jb3NEZXZpY2UiLCJfcGF0aCIsIl9sb2Rhc2giLCJfcHlJb3NEZXZpY2VDbGllbnQiLCJSRUFMX0RFVklDRV9NQUdJQyIsIk1BR0lDX1NFUCIsIklPU0NyYXNoTG9nIiwiY29uc3RydWN0b3IiLCJvcHRzIiwidWRpZCIsInB5aWRldmljZUNsaWVudCIsIlB5aWRldmljZSIsImxvZ0RpciIsInBhdGgiLCJyZXNvbHZlIiwicHJvY2VzcyIsImVudiIsIkhPTUUiLCJwcmV2TG9ncyIsImxvZ3NTaW5jZUxhc3RSZXF1ZXN0IiwicGhvbmVOYW1lIiwic2ltIiwiX2dhdGhlckZyb21SZWFsRGV2aWNlIiwiYXNzZXJ0RXhpc3RzIiwibGlzdENyYXNoZXMiLCJtYXAiLCJ4IiwiY3Jhc2hMb2dzUm9vdCIsInV0aWxpdGllcyIsImdldERldmljZU5hbWUiLCJmcyIsImV4aXN0cyIsImxvZyIsImRlYnVnIiwiZm91bmRGaWxlcyIsImdsb2IiLCJzdHJpY3QiLCJfZ2F0aGVyRnJvbVNpbXVsYXRvciIsIkIiLCJmaWx0ZXIiLCJjb250ZW50IiwicmVhZEZpbGUiLCJ0b1VwcGVyQ2FzZSIsImluY2x1ZGVzIiwiZXJyIiwiZ2V0Q3Jhc2hlcyIsInN0YXJ0Q2FwdHVyZSIsInN0b3BDYXB0dXJlIiwiZ2V0TG9ncyIsImNyYXNoRmlsZXMiLCJkaWZmIiwiXyIsImRpZmZlcmVuY2UiLCJ1bmlvbiIsImZpbGVzVG9KU09OIiwiZ2V0QWxsTG9ncyIsImxvZ0ZpbGVzIiwicGF0aHMiLCJ0bXBSb290IiwidGVtcERpciIsIm9wZW5EaXIiLCJmdWxsUGF0aCIsImZpbGVOYW1lIiwibGFzdCIsInNwbGl0IiwiZXhwb3J0Q3Jhc2giLCJlIiwid2FybiIsIm1lc3NhZ2UiLCJqb2luIiwic3RhdCIsInRpbWVzdGFtcCIsImN0aW1lIiwiZ2V0VGltZSIsImxldmVsIiwiQm9vbGVhbiIsInJpbXJhZiIsImV4cG9ydHMiLCJfZGVmYXVsdCIsImRlZmF1bHQiXSwic291cmNlcyI6WyIuLi8uLi8uLi9saWIvZGV2aWNlLWxvZy9pb3MtY3Jhc2gtbG9nLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGZzLCB0ZW1wRGlyIH0gZnJvbSAnYXBwaXVtL3N1cHBvcnQnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IGxvZyBmcm9tICcuLi9sb2dnZXInO1xuaW1wb3J0IHsgdXRpbGl0aWVzIH0gZnJvbSAnYXBwaXVtLWlvcy1kZXZpY2UnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IFB5aWRldmljZSBmcm9tICcuLi9weS1pb3MtZGV2aWNlLWNsaWVudCc7XG5cbmNvbnN0IFJFQUxfREVWSUNFX01BR0lDID0gJzM2MjBiYmIwLWZiOWYtNGI2Mi1hNjY4LTg5NmYyZWRjNGQ4OCc7XG5jb25zdCBNQUdJQ19TRVAgPSAnLyc7XG5cblxuY2xhc3MgSU9TQ3Jhc2hMb2cge1xuICBjb25zdHJ1Y3RvciAob3B0cyA9IHt9KSB7XG4gICAgdGhpcy51ZGlkID0gb3B0cy51ZGlkO1xuICAgIHRoaXMucHlpZGV2aWNlQ2xpZW50ID0gdGhpcy51ZGlkID8gbmV3IFB5aWRldmljZSh0aGlzLnVkaWQpIDogbnVsbDtcbiAgICBjb25zdCBsb2dEaXIgPSBvcHRzLnVkaWRcbiAgICAgID8gcGF0aC5yZXNvbHZlKHByb2Nlc3MuZW52LkhPTUUsICdMaWJyYXJ5JywgJ0xvZ3MnLCAnQ3Jhc2hSZXBvcnRlcicsICdNb2JpbGVEZXZpY2UnKVxuICAgICAgOiBwYXRoLnJlc29sdmUocHJvY2Vzcy5lbnYuSE9NRSwgJ0xpYnJhcnknLCAnTG9ncycsICdEaWFnbm9zdGljUmVwb3J0cycpO1xuICAgIHRoaXMubG9nRGlyID0gbG9nRGlyXG4gICAgICB8fCBwYXRoLnJlc29sdmUocHJvY2Vzcy5lbnYuSE9NRSB8fCAnLycsICdMaWJyYXJ5JywgJ0xvZ3MnLCAnRGlhZ25vc3RpY1JlcG9ydHMnKTtcbiAgICB0aGlzLnByZXZMb2dzID0gW107XG4gICAgdGhpcy5sb2dzU2luY2VMYXN0UmVxdWVzdCA9IFtdO1xuICAgIHRoaXMucGhvbmVOYW1lID0gbnVsbDtcbiAgICB0aGlzLnNpbSA9IG9wdHMuc2ltO1xuICB9XG5cbiAgYXN5bmMgX2dhdGhlckZyb21SZWFsRGV2aWNlICgpIHtcbiAgICBpZiAoYXdhaXQgdGhpcy5weWlkZXZpY2VDbGllbnQuYXNzZXJ0RXhpc3RzKGZhbHNlKSkge1xuICAgICAgcmV0dXJuIChhd2FpdCB0aGlzLnB5aWRldmljZUNsaWVudC5saXN0Q3Jhc2hlcygpKVxuICAgICAgICAubWFwKCh4KSA9PiBgJHtSRUFMX0RFVklDRV9NQUdJQ30ke01BR0lDX1NFUH0ke3h9YCk7XG4gICAgfVxuXG4gICAgbGV0IGNyYXNoTG9nc1Jvb3QgPSB0aGlzLmxvZ0RpcjtcbiAgICBpZiAodGhpcy51ZGlkKSB7XG4gICAgICB0aGlzLnBob25lTmFtZSA9IHRoaXMucGhvbmVOYW1lIHx8IGF3YWl0IHV0aWxpdGllcy5nZXREZXZpY2VOYW1lKHRoaXMudWRpZCk7XG4gICAgICBjcmFzaExvZ3NSb290ID0gcGF0aC5yZXNvbHZlKGNyYXNoTG9nc1Jvb3QsIHRoaXMucGhvbmVOYW1lKTtcbiAgICB9XG4gICAgaWYgKCFhd2FpdCBmcy5leGlzdHMoY3Jhc2hMb2dzUm9vdCkpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgQ3Jhc2ggcmVwb3J0cyByb290ICcke2NyYXNoTG9nc1Jvb3R9JyBkb2VzIG5vdCBleGlzdC4gR290IG5vdGhpbmcgdG8gZ2F0aGVyLmApO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBjb25zdCBmb3VuZEZpbGVzID0gYXdhaXQgZnMuZ2xvYihgJHtjcmFzaExvZ3NSb290fS8qKi8qLmNyYXNoYCwge1xuICAgICAgc3RyaWN0OiBmYWxzZVxuICAgIH0pO1xuICAgIHJldHVybiBmb3VuZEZpbGVzO1xuICB9XG5cbiAgYXN5bmMgX2dhdGhlckZyb21TaW11bGF0b3IgKCkge1xuICAgIGlmICghYXdhaXQgZnMuZXhpc3RzKHRoaXMubG9nRGlyKSkge1xuICAgICAgbG9nLmRlYnVnKGBDcmFzaCByZXBvcnRzIHJvb3QgJyR7dGhpcy5sb2dEaXJ9JyBkb2VzIG5vdCBleGlzdC4gR290IG5vdGhpbmcgdG8gZ2F0aGVyLmApO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICAvLyBUaGUgZmlsZSBmb3JtYXQgaGFzIGJlZW4gY2hhbmdlZCBmcm9tICcuY3Jhc2gnIHRvICcuaXBzJyBzaW5jZSBNb250ZXJleS5cbiAgICBjb25zdCBmb3VuZEZpbGVzID0gYXdhaXQgZnMuZ2xvYihgJHt0aGlzLmxvZ0Rpcn0vKiovKi4rKGNyYXNofGlwcylgLCB7XG4gICAgICBzdHJpY3Q6IGZhbHNlXG4gICAgfSk7XG4gICAgLy8gRm9yIFNpbXVsYXRvciBvbmx5IGluY2x1ZGUgZmlsZXMsIHRoYXQgY29udGFpbiBjdXJyZW50IFVESURcbiAgICByZXR1cm4gYXdhaXQgQi5maWx0ZXIoZm91bmRGaWxlcywgYXN5bmMgKHgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBmcy5yZWFkRmlsZSh4LCAndXRmOCcpO1xuICAgICAgICByZXR1cm4gY29udGVudC50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKHRoaXMuc2ltLnVkaWQudG9VcHBlckNhc2UoKSk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgZ2V0Q3Jhc2hlcyAoKSB7XG4gICAgcmV0dXJuIHRoaXMudWRpZFxuICAgICAgPyBhd2FpdCB0aGlzLl9nYXRoZXJGcm9tUmVhbERldmljZSgpXG4gICAgICA6IGF3YWl0IHRoaXMuX2dhdGhlckZyb21TaW11bGF0b3IoKTtcbiAgfVxuXG4gIGFzeW5jIHN0YXJ0Q2FwdHVyZSAoKSB7XG4gICAgdGhpcy5wcmV2TG9ncyA9IGF3YWl0IHRoaXMuZ2V0Q3Jhc2hlcygpO1xuICB9XG5cbiAgYXN5bmMgc3RvcENhcHR1cmUgKCkge1xuICAgIC8vIG5lZWRlZCBmb3IgY29uc2lzdGVudCBBUEkgd2l0aCBvdGhlciBsb2dzXG4gIH1cblxuICBhc3luYyBnZXRMb2dzICgpIHtcbiAgICBsZXQgY3Jhc2hGaWxlcyA9IGF3YWl0IHRoaXMuZ2V0Q3Jhc2hlcygpO1xuICAgIGxldCBkaWZmID0gXy5kaWZmZXJlbmNlKGNyYXNoRmlsZXMsIHRoaXMucHJldkxvZ3MsIHRoaXMubG9nc1NpbmNlTGFzdFJlcXVlc3QpO1xuICAgIHRoaXMubG9nc1NpbmNlTGFzdFJlcXVlc3QgPSBfLnVuaW9uKHRoaXMubG9nc1NpbmNlTGFzdFJlcXVlc3QsIGRpZmYpO1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmZpbGVzVG9KU09OKGRpZmYpO1xuICB9XG5cbiAgYXN5bmMgZ2V0QWxsTG9ncyAoKSB7XG4gICAgbGV0IGNyYXNoRmlsZXMgPSBhd2FpdCB0aGlzLmdldENyYXNoZXMoKTtcbiAgICBsZXQgbG9nRmlsZXMgPSBfLmRpZmZlcmVuY2UoY3Jhc2hGaWxlcywgdGhpcy5wcmV2TG9ncyk7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZmlsZXNUb0pTT04obG9nRmlsZXMpO1xuICB9XG5cbiAgYXN5bmMgZmlsZXNUb0pTT04gKHBhdGhzKSB7XG4gICAgY29uc3QgdG1wUm9vdCA9IGF3YWl0IHRlbXBEaXIub3BlbkRpcigpO1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gKGF3YWl0IEIubWFwKHBhdGhzLCBhc3luYyAoZnVsbFBhdGgpID0+IHtcbiAgICAgICAgaWYgKF8uaW5jbHVkZXMoZnVsbFBhdGgsIFJFQUxfREVWSUNFX01BR0lDKSkge1xuICAgICAgICAgIGNvbnN0IGZpbGVOYW1lID0gXy5sYXN0KGZ1bGxQYXRoLnNwbGl0KE1BR0lDX1NFUCkpO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnB5aWRldmljZUNsaWVudC5leHBvcnRDcmFzaChmaWxlTmFtZSwgdG1wUm9vdCk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgbG9nLndhcm4oYENhbm5vdCBleHBvcnQgdGhlIGNyYXNoIHJlcG9ydCAnJHtmaWxlTmFtZX0nLiBTa2lwcGluZyBpdC4gYCArXG4gICAgICAgICAgICAgIGBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGZ1bGxQYXRoID0gcGF0aC5qb2luKHRtcFJvb3QsIGZpbGVOYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdGF0ID0gYXdhaXQgZnMuc3RhdChmdWxsUGF0aCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdGltZXN0YW1wOiBzdGF0LmN0aW1lLmdldFRpbWUoKSxcbiAgICAgICAgICBsZXZlbDogJ0FMTCcsXG4gICAgICAgICAgbWVzc2FnZTogYXdhaXQgZnMucmVhZEZpbGUoZnVsbFBhdGgsICd1dGY4JylcbiAgICAgICAgfTtcbiAgICAgIH0pKS5maWx0ZXIoQm9vbGVhbik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGF3YWl0IGZzLnJpbXJhZih0bXBSb290KTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IHsgSU9TQ3Jhc2hMb2cgfTtcbmV4cG9ydCBkZWZhdWx0IElPU0NyYXNoTG9nO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLElBQUFBLFFBQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFHLE9BQUEsR0FBQUQsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFJLGdCQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxLQUFBLEdBQUFILHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBTSxPQUFBLEdBQUFKLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJ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