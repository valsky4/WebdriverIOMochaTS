{"version":3,"file":"rotating-log.js","names":["_lodash","_interopRequireDefault","require","_support","MAX_LOG_ENTRIES_COUNT","exports","RotatingLog","constructor","showLogs","label","log","logger","getLogger","logs","logIdxSinceLastRequest","isCapturing","startCapture","stopCapture","addLogLine","getLogs","length","result","slice","getAllLogs","_","clone","_logs","_default","default"],"sources":["../../../lib/device-log/rotating-log.js"],"sourcesContent":["import _ from 'lodash';\nimport { logger } from 'appium/support';\n\n\nconst MAX_LOG_ENTRIES_COUNT = 10000;\n\nclass RotatingLog {\n  constructor (showLogs = false, label = 'Log Label') {\n    this.log = logger.getLogger(label);\n\n    this.showLogs = showLogs;\n    this.logs = [];\n    this.logIdxSinceLastRequest = 0;\n\n    this.isCapturing = false;\n  }\n\n  async startCapture () { // eslint-disable-line require-await\n    this.isCapturing = true;\n  }\n\n  async stopCapture () { // eslint-disable-line require-await\n    this.isCapturing = false;\n  }\n\n  /*\n   * @override\n   */\n  addLogLine () {\n  }\n\n  async getLogs () { // eslint-disable-line require-await\n    if (this.logs.length && this.logIdxSinceLastRequest < this.logs.length) {\n      let result = this.logs;\n      if (this.logIdxSinceLastRequest > 0) {\n        result = result.slice(this.logIdxSinceLastRequest);\n      }\n      this.logIdxSinceLastRequest = this.logs.length;\n      return result;\n    }\n    return [];\n  }\n\n  async getAllLogs () { // eslint-disable-line require-await\n    return _.clone(this.logs);\n  }\n\n  get logs () {\n    if (!this._logs) {\n      this.logs = [];\n    }\n    return this._logs;\n  }\n\n  set logs (logs) {\n    this._logs = logs;\n  }\n}\n\nexport { RotatingLog, MAX_LOG_ENTRIES_COUNT };\nexport default RotatingLog;\n"],"mappings":";;;;;;;;AAAA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,QAAA,GAAAD,OAAA;AAGA,MAAME,qBAAqB,GAAG,KAAK;AAACC,OAAA,CAAAD,qBAAA,GAAAA,qBAAA;AAEpC,MAAME,WAAW,CAAC;EAChBC,WAAWA,CAAEC,QAAQ,GAAG,KAAK,EAAEC,KAAK,GAAG,WAAW,EAAE;IAClD,IAAI,CAACC,GAAG,GAAGC,eAAM,CAACC,SAAS,CAACH,KAAK,CAAC;IAElC,IAAI,CAACD,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAACK,IAAI,GAAG,EAAE;IACd,IAAI,CAACC,sBAAsB,GAAG,CAAC;IAE/B,IAAI,CAACC,WAAW,GAAG,KAAK;EAC1B;EAEA,MAAMC,YAAYA,CAAA,EAAI;IACpB,IAAI,CAACD,WAAW,GAAG,IAAI;EACzB;EAEA,MAAME,WAAWA,CAAA,EAAI;IACnB,IAAI,CAACF,WAAW,GAAG,KAAK;EAC1B;EAKAG,UAAUA,CAAA,EAAI,CACd;EAEA,MAAMC,OAAOA,CAAA,EAAI;IACf,IAAI,IAAI,CAACN,IAAI,CAACO,MAAM,IAAI,IAAI,CAACN,sBAAsB,GAAG,IAAI,CAACD,IAAI,CAACO,MAAM,EAAE;MACtE,IAAIC,MAAM,GAAG,IAAI,CAACR,IAAI;MACtB,IAAI,IAAI,CAACC,sBAAsB,GAAG,CAAC,EAAE;QACnCO,MAAM,GAAGA,MAAM,CAACC,KAAK,CAAC,IAAI,CAACR,sBAAsB,CAAC;MACpD;MACA,IAAI,CAACA,sBAAsB,GAAG,IAAI,CAACD,IAAI,CAACO,MAAM;MAC9C,OAAOC,MAAM;IACf;IACA,OAAO,EAAE;EACX;EAEA,MAAME,UAAUA,CAAA,EAAI;IAClB,OAAOC,eAAC,CAACC,KAAK,CAAC,IAAI,CAACZ,IAAI,CAAC;EAC3B;EAEA,IAAIA,IAAIA,CAAA,EAAI;IACV,IAAI,CAAC,IAAI,CAACa,KAAK,EAAE;MACf,IAAI,CAACb,IAAI,GAAG,EAAE;IAChB;IACA,OAAO,IAAI,CAACa,KAAK;EACnB;EAEA,IAAIb,IAAIA,CAAEA,IAAI,EAAE;IACd,IAAI,CAACa,KAAK,GAAGb,IAAI;EACnB;AACF;AAACR,OAAA,CAAAC,WAAA,GAAAA,WAAA;AAAA,IAAAqB,QAAA,GAGcrB,WAAW;AAAAD,OAAA,CAAAuB,OAAA,GAAAD,QAAA"}