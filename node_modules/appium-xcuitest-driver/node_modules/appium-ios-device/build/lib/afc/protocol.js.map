{"version":3,"file":"protocol.js","names":["_lodash","_interopRequireDefault","require","MAGIC_NUMBER","Buffer","from","exports","AFC_PACKET_HEADER_SIZE","Operations","INVALID","STATUS","DATA","READ_DIR","READ_FILE","WRITE_FILE","WRITE_PART","TRUNCATE","REMOVE_PATH","MAKE_DIR","GET_FILE_INFO","GET_DEVINFO","WRITE_FILE_ATOM","FILE_OPEN","FILE_OPEN_RES","FILE_READ","FILE_WRITE","FILE_SEEK","FILE_TELL","FILE_TELL_RES","FILE_CLOSE","FILE_SET_SIZE","GET_CON_INFO","SET_CON_OPTIONS","RENAME_PATH","SET_FS_BS","SET_SOCKET_BS","FILE_LOCK","MAKE_LINK","GET_FILE_HASH","SET_FILE_MOD_TIME","GET_FILE_HASH_RANGE","FILE_SET_IMMUTABLE_HINT","GET_SIZE_OF_PATH_CONTENTS","REMOVE_PATH_AND_CONTENTS","DIR_OPEN","DIR_OPEN_RESULT","DIR_READ","DIR_CLOSE","FILE_READ_OFFSET","FILE_WRITE_OFFSET","Operations_Code","_","invert","operationCode","code","Errors","SUCCESS","UNKNOWN","INVALID_HEADER","NO_RESOURCES","READ","WRITE","UNKNOWN_PACKET_TYPE","INVALID_ARGUMENT","OBJECT_NOT_FOUND","OBJECT_IS_DIRECTORY","PERMISSION_DENIED","NOT_CONNECTED","TIMEOUT","OVERRUN","EOF","UNSUPPORTED","OBJECT_EXISTS","OBJECT_BUSY","ON_SPACE_LEFT","WOULD_BLOCK","IO","INTERRUPTED","IN_PROGRESS","INTERNAL","Errors_Code","errorCode","FileModes"],"sources":["../../../lib/afc/protocol.js"],"sourcesContent":["import _ from 'lodash';\n\nconst MAGIC_NUMBER = Buffer.from('CFA6LPAA');\n\nconst AFC_PACKET_HEADER_SIZE = 40;\n\nconst Operations = {\n  INVALID: 0x00000000,\t// Invalid\n  STATUS: 0x00000001,\t// Status\n  DATA: 0x00000002,\t// Data\n  READ_DIR: 0x00000003,\t// ReadDir\n  READ_FILE: 0x00000004,\t// ReadFile\n  WRITE_FILE: 0x00000005,\t// WriteFile\n  WRITE_PART: 0x00000006,\t// WritePart\n  TRUNCATE: 0x00000007,\t// TruncateFile\n  REMOVE_PATH: 0x00000008,\t// RemovePath\n  MAKE_DIR: 0x00000009,\t// MakeDir\n  GET_FILE_INFO: 0x0000000A,\t// GetFileInfo\n  GET_DEVINFO: 0x0000000B,\t// GetDeviceInfo\n  WRITE_FILE_ATOM: 0x0000000C,\t// WriteFileAtomic (tmp file+rename)\n  FILE_OPEN: 0x0000000D,\t// FileRefOpen\n  FILE_OPEN_RES: 0x0000000E,\t// FileRefOpenResult\n  FILE_READ: 0x0000000F,\t// FileRefRead\n  FILE_WRITE: 0x00000010,\t// FileRefWrite\n  FILE_SEEK: 0x00000011,\t// FileRefSeek\n  FILE_TELL: 0x00000012,\t// FileRefTell\n  FILE_TELL_RES: 0x00000013,\t// FileRefTellResult\n  FILE_CLOSE: 0x00000014,\t// FileRefClose\n  FILE_SET_SIZE: 0x00000015,\t// FileRefSetFileSize (ftruncate)\n  GET_CON_INFO: 0x00000016,\t// GetConnectionInfo\n  SET_CON_OPTIONS: 0x00000017,\t// SetConnectionOptions\n  RENAME_PATH: 0x00000018,\t// RenamePath\n  SET_FS_BS: 0x00000019,\t// SetFSBlockSize (0x800000)\n  SET_SOCKET_BS: 0x0000001A,\t// SetSocketBlockSize (0x800000)\n  FILE_LOCK: 0x0000001B,\t// FileRefLock\n  MAKE_LINK: 0x0000001C,\t// MakeLink\n  GET_FILE_HASH: 0x0000001D,\t// GetFileHash\n  SET_FILE_MOD_TIME: 0x0000001E,\t// SetModTime\n  GET_FILE_HASH_RANGE: 0x0000001F,\t// GetFileHashWithRange\n  FILE_SET_IMMUTABLE_HINT: 0x00000020,\t// FileRefSetImmutableHint\n  GET_SIZE_OF_PATH_CONTENTS: 0x00000021,\t// GetSizeOfPathContents\n  REMOVE_PATH_AND_CONTENTS: 0x00000022,\t// RemovePathAndContents\n  DIR_OPEN: 0x00000023,\t// DirectoryEnumeratorRefOpen\n  DIR_OPEN_RESULT: 0x00000024,\t// DirectoryEnumeratorRefOpenResult\n  DIR_READ: 0x00000025,\t// DirectoryEnumeratorRefRead\n  DIR_CLOSE: 0x00000026,\t// DirectoryEnumeratorRefClose\n  FILE_READ_OFFSET: 0x00000027,\t// FileRefReadWithOffset\n  FILE_WRITE_OFFSET:\t0x00000028\t// FileRefWriteWithOffset\n};\n\nconst Operations_Code = _.invert(Operations);\n\nfunction operationCode (code) {\n  return Operations_Code[code];\n}\n\nconst Errors = {\n  SUCCESS: 0,\n  UNKNOWN: 1,\n  INVALID_HEADER: 2,\n  NO_RESOURCES: 3,\n  READ: 4,\n  WRITE: 5,\n  UNKNOWN_PACKET_TYPE: 6,\n  INVALID_ARGUMENT: 7,\n  OBJECT_NOT_FOUND: 8,\n  OBJECT_IS_DIRECTORY: 9,\n  PERMISSION_DENIED: 10,\n  NOT_CONNECTED: 11,\n  TIMEOUT: 12,\n  OVERRUN: 13,\n  EOF: 14,\n  UNSUPPORTED: 15,\n  OBJECT_EXISTS: 16,\n  OBJECT_BUSY: 17,\n  ON_SPACE_LEFT: 18,\n  WOULD_BLOCK: 19,\n  IO: 20,\n  INTERRUPTED: 21,\n  IN_PROGRESS: 22,\n  INTERNAL: 23,\n};\n\nconst Errors_Code = _.invert(Errors);\n\nfunction errorCode (code) {\n  return Errors_Code[code];\n}\n\n\nconst FileModes = {\n  'r': 0x00000001, // O_RDONLY\n  'r+': 0x00000002, // O_RDWR   | O_CREAT\n  'w': 0x00000003, // O_WRONLY | O_CREAT  | O_TRUNC\n  'w+': 0x00000004, // O_RDWR   | O_CREAT  | O_TRUNC\n  'a': 0x00000005, // O_WRONLY | O_APPEND | O_CREAT\n  'a+': 0x00000006, // O_RDWR   | O_APPEND | O_CREAT\n};\n\nexport {\n  MAGIC_NUMBER, AFC_PACKET_HEADER_SIZE,\n  Operations, operationCode,\n  Errors, errorCode, FileModes,\n};\n"],"mappings":"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"}