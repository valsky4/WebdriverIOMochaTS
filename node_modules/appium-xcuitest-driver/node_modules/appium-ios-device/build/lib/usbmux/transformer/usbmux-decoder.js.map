{"version":3,"file":"usbmux-decoder.js","names":["_stream","_interopRequireDefault","require","_support","HEADER_LENGTH","UsbmuxDecoder","Stream","Transform","constructor","objectMode","_transform","data","encoding","onData","_decode","header","length","readUInt32LE","version","type","tag","payload","slice","push","plist","parsePlist","exports","_default","default"],"sources":["../../../../lib/usbmux/transformer/usbmux-decoder.js"],"sourcesContent":["import Stream from 'stream';\nimport { plist } from '@appium/support';\n\nconst HEADER_LENGTH = 16;\n\nclass UsbmuxDecoder extends Stream.Transform {\n\n  constructor () {\n    super({ objectMode: true });\n  }\n\n  _transform (data, encoding, onData) {\n    this._decode(data);\n    onData();\n  }\n\n  _decode (data) {\n    const header = {\n      length: data.readUInt32LE(0),\n      version: data.readUInt32LE(4),\n      type: data.readUInt32LE(8),\n      tag: data.readUInt32LE(12)\n    };\n\n    let payload = data.slice(HEADER_LENGTH, data.length);\n    this.push({ header, payload: plist.parsePlist(payload) });\n  }\n\n}\n\nexport { UsbmuxDecoder };\nexport default UsbmuxDecoder;\n"],"mappings":";;;;;;;;AAAA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,QAAA,GAAAD,OAAA;AAEA,MAAME,aAAa,GAAG,EAAE;AAExB,MAAMC,aAAa,SAASC,eAAM,CAACC,SAAS,CAAC;EAE3CC,WAAWA,CAAA,EAAI;IACb,KAAK,CAAC;MAAEC,UAAU,EAAE;IAAK,CAAC,CAAC;EAC7B;EAEAC,UAAUA,CAAEC,IAAI,EAAEC,QAAQ,EAAEC,MAAM,EAAE;IAClC,IAAI,CAACC,OAAO,CAACH,IAAI,CAAC;IAClBE,MAAM,EAAE;EACV;EAEAC,OAAOA,CAAEH,IAAI,EAAE;IACb,MAAMI,MAAM,GAAG;MACbC,MAAM,EAAEL,IAAI,CAACM,YAAY,CAAC,CAAC,CAAC;MAC5BC,OAAO,EAAEP,IAAI,CAACM,YAAY,CAAC,CAAC,CAAC;MAC7BE,IAAI,EAAER,IAAI,CAACM,YAAY,CAAC,CAAC,CAAC;MAC1BG,GAAG,EAAET,IAAI,CAACM,YAAY,CAAC,EAAE;IAC3B,CAAC;IAED,IAAII,OAAO,GAAGV,IAAI,CAACW,KAAK,CAAClB,aAAa,EAAEO,IAAI,CAACK,MAAM,CAAC;IACpD,IAAI,CAACO,IAAI,CAAC;MAAER,MAAM;MAAEM,OAAO,EAAEG,cAAK,CAACC,UAAU,CAACJ,OAAO;IAAE,CAAC,CAAC;EAC3D;AAEF;AAACK,OAAA,CAAArB,aAAA,GAAAA,aAAA;AAAA,IAAAsB,QAAA,GAGctB,aAAa;AAAAqB,OAAA,CAAAE,OAAA,GAAAD,QAAA"}