{"version":3,"file":"simulator-xcode-9.3.js","names":["SimulatorXcode93","SimulatorXcode9","constructor","udid","xcodeVersion","webInspectorSocket","getWebInspectorSocket","stdout","exec","udidPattern","udidMatch","match","RegExp","log","debug","pidPattern","pidMatch"],"sources":["../../lib/simulator-xcode-9.3.js"],"sourcesContent":["import SimulatorXcode9 from './simulator-xcode-9';\nimport { exec } from 'teen_process';\nimport log from './logger';\n\n\nclass SimulatorXcode93 extends SimulatorXcode9 {\n  constructor (udid, xcodeVersion) {\n    super(udid, xcodeVersion);\n\n    this.webInspectorSocket = null;\n  }\n\n  /*\n   * @override\n   */\n  async getWebInspectorSocket () {\n    if (this.webInspectorSocket) {\n      return this.webInspectorSocket;\n    }\n\n    // lsof -aUc launchd_sim gives a set of records like\n    // https://github.com/appium/appium-ios-simulator/commit/c00901a9ddea178c5581a7a57d96d8cee3f17c59#diff-2be09dd2ea01cfd6bbbd73e10bc468da782a297365eec706999fc3709c01478dR102\n    // these _appear_ to always be grouped together by PID for each simulator.\n    // Therefore, by obtaining simulator PID with an expected simulator UDID,\n    // we can get the correct `com.apple.webinspectord_sim.socket`\n    // without depending on the order of `lsof -aUc launchd_sim` result.\n    const {stdout} = await exec('lsof', ['-aUc', 'launchd_sim']);\n    const udidPattern = `([0-9]{1,5}).+${this.udid}`;\n    const udidMatch = stdout.match(new RegExp(udidPattern));\n    if (!udidMatch) {\n      log.debug(`Failed to get Web Inspector socket. lsof result: ${stdout}`);\n      return null;\n    }\n\n    const pidPattern = `${udidMatch[1]}.+\\\\s+(\\\\S+com\\\\.apple\\\\.webinspectord_sim\\\\.socket)`;\n    const pidMatch = stdout.match(new RegExp(pidPattern));\n    if (!pidMatch) {\n      log.debug(`Failed to get Web Inspector socket. lsof result: ${stdout}`);\n      return null;\n    }\n    this.webInspectorSocket = pidMatch[1];\n    return this.webInspectorSocket;\n  }\n}\n\nexport default SimulatorXcode93;\n"],"mappings":";;;;;;;;AAAA;AACA;AACA;AAGA,MAAMA,gBAAgB,SAASC,uBAAe,CAAC;EAC7CC,WAAW,CAAEC,IAAI,EAAEC,YAAY,EAAE;IAC/B,KAAK,CAACD,IAAI,EAAEC,YAAY,CAAC;IAEzB,IAAI,CAACC,kBAAkB,GAAG,IAAI;EAChC;EAKA,MAAMC,qBAAqB,GAAI;IAC7B,IAAI,IAAI,CAACD,kBAAkB,EAAE;MAC3B,OAAO,IAAI,CAACA,kBAAkB;IAChC;IAQA,MAAM;MAACE;IAAM,CAAC,GAAG,MAAM,IAAAC,kBAAI,EAAC,MAAM,EAAE,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;IAC5D,MAAMC,WAAW,GAAI,iBAAgB,IAAI,CAACN,IAAK,EAAC;IAChD,MAAMO,SAAS,GAAGH,MAAM,CAACI,KAAK,CAAC,IAAIC,MAAM,CAACH,WAAW,CAAC,CAAC;IACvD,IAAI,CAACC,SAAS,EAAE;MACdG,eAAG,CAACC,KAAK,CAAE,oDAAmDP,MAAO,EAAC,CAAC;MACvE,OAAO,IAAI;IACb;IAEA,MAAMQ,UAAU,GAAI,GAAEL,SAAS,CAAC,CAAC,CAAE,sDAAqD;IACxF,MAAMM,QAAQ,GAAGT,MAAM,CAACI,KAAK,CAAC,IAAIC,MAAM,CAACG,UAAU,CAAC,CAAC;IACrD,IAAI,CAACC,QAAQ,EAAE;MACbH,eAAG,CAACC,KAAK,CAAE,oDAAmDP,MAAO,EAAC,CAAC;MACvE,OAAO,IAAI;IACb;IACA,IAAI,CAACF,kBAAkB,GAAGW,QAAQ,CAAC,CAAC,CAAC;IACrC,OAAO,IAAI,CAACX,kBAAkB;EAChC;AACF;AAAC,eAEcL,gBAAgB;AAAA"}