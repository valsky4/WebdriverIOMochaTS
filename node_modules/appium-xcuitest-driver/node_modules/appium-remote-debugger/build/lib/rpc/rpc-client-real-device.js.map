{"version":3,"file":"rpc-client-real-device.js","names":["_logger","_interopRequireDefault","require","_rpcClient","_appiumIosDevice","RpcClientRealDevice","RpcClient","constructor","opts","Object","assign","shouldCheckForTarget","udid","connect","service","services","startWebInspectorService","osVersion","platformVersion","isSimulator","verbose","logAllCommunication","verboseHexDump","logAllCommunicationHexDump","socketChunkSize","maxFrameLength","webInspectorMaxFrameLength","listenMessage","receive","bind","isConnected","disconnect","log","debug","close","sendMessage","cmd","data","messageHandler","handleMessage","exports","default"],"sources":["../../../lib/rpc/rpc-client-real-device.js"],"sourcesContent":["import log from '../logger';\nimport RpcClient from './rpc-client';\nimport { services } from 'appium-ios-device';\n\n\nexport default class RpcClientRealDevice extends RpcClient {\n  constructor (opts = {}) {\n    super(Object.assign({\n      shouldCheckForTarget: false,\n    }, opts));\n\n    const {\n      udid,\n    } = opts;\n\n    this.udid = udid;\n  }\n\n  async connect () {\n    this.service = await services.startWebInspectorService(this.udid, {\n      osVersion: this.platformVersion,\n      isSimulator: false,\n      verbose: this.logAllCommunication,\n      verboseHexDump: this.logAllCommunicationHexDump,\n      socketChunkSize: this.socketChunkSize,\n      maxFrameLength: this.webInspectorMaxFrameLength,\n    });\n\n    this.service.listenMessage(this.receive.bind(this));\n    this.isConnected = true;\n  }\n\n  async disconnect () {\n    if (!this.isConnected) {\n      return;\n    }\n\n    log.debug('Disconnecting from remote debugger');\n    await super.disconnect();\n    this.service.close();\n    this.isConnected = false;\n  }\n\n  async sendMessage (cmd) { // eslint-disable-line require-await\n    this.service.sendMessage(cmd);\n  }\n\n  async receive (data) {\n    if (!this.isConnected) {\n      return;\n    }\n    await this.messageHandler.handleMessage(data);\n  }\n}\n"],"mappings":";;;;;;;;AAAA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,UAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,gBAAA,GAAAF,OAAA;AAGe,MAAMG,mBAAmB,SAASC,kBAAS,CAAC;EACzDC,WAAWA,CAAEC,IAAI,GAAG,CAAC,CAAC,EAAE;IACtB,KAAK,CAACC,MAAM,CAACC,MAAM,CAAC;MAClBC,oBAAoB,EAAE;IACxB,CAAC,EAAEH,IAAI,CAAC,CAAC;IAET,MAAM;MACJI;IACF,CAAC,GAAGJ,IAAI;IAER,IAAI,CAACI,IAAI,GAAGA,IAAI;EAClB;EAEA,MAAMC,OAAOA,CAAA,EAAI;IACf,IAAI,CAACC,OAAO,GAAG,MAAMC,yBAAQ,CAACC,wBAAwB,CAAC,IAAI,CAACJ,IAAI,EAAE;MAChEK,SAAS,EAAE,IAAI,CAACC,eAAe;MAC/BC,WAAW,EAAE,KAAK;MAClBC,OAAO,EAAE,IAAI,CAACC,mBAAmB;MACjCC,cAAc,EAAE,IAAI,CAACC,0BAA0B;MAC/CC,eAAe,EAAE,IAAI,CAACA,eAAe;MACrCC,cAAc,EAAE,IAAI,CAACC;IACvB,CAAC,CAAC;IAEF,IAAI,CAACZ,OAAO,CAACa,aAAa,CAAC,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;IACnD,IAAI,CAACC,WAAW,GAAG,IAAI;EACzB;EAEA,MAAMC,UAAUA,CAAA,EAAI;IAClB,IAAI,CAAC,IAAI,CAACD,WAAW,EAAE;MACrB;IACF;IAEAE,eAAG,CAACC,KAAK,CAAC,oCAAoC,CAAC;IAC/C,MAAM,KAAK,CAACF,UAAU,EAAE;IACxB,IAAI,CAACjB,OAAO,CAACoB,KAAK,EAAE;IACpB,IAAI,CAACJ,WAAW,GAAG,KAAK;EAC1B;EAEA,MAAMK,WAAWA,CAAEC,GAAG,EAAE;IACtB,IAAI,CAACtB,OAAO,CAACqB,WAAW,CAACC,GAAG,CAAC;EAC/B;EAEA,MAAMR,OAAOA,CAAES,IAAI,EAAE;IACnB,IAAI,CAAC,IAAI,CAACP,WAAW,EAAE;MACrB;IACF;IACA,MAAM,IAAI,CAACQ,cAAc,CAACC,aAAa,CAACF,IAAI,CAAC;EAC/C;AACF;AAACG,OAAA,CAAAC,OAAA,GAAApC,mBAAA"}