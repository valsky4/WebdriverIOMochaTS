{"version":3,"file":"check-dependencies.js","names":["_support","require","_lodash","_interopRequireDefault","_teen_process","_path","_xcodebuild","_constants","_utils","_logger","buildWDASim","args","path","join","BOOTSTRAP_PATH","WDA_SCHEME","SDK_SIMULATOR","exec","checkForDependencies","log","debug","bundleWDASim","xcodebuild","opts","_","isFunction","retrieveDerivedDataPath","XcodeBuild","derivedDataPath","wdaBundlePath","WDA_RUNNER_APP","fs","exists"],"sources":["../../lib/check-dependencies.js"],"sourcesContent":["import { fs } from '@appium/support';\nimport _ from 'lodash';\nimport { exec } from 'teen_process';\nimport path from 'path';\nimport XcodeBuild from './xcodebuild';\nimport {\n  WDA_SCHEME, SDK_SIMULATOR, WDA_RUNNER_APP\n} from './constants';\nimport { BOOTSTRAP_PATH } from './utils';\nimport log from './logger';\n\nasync function buildWDASim () {\n  const args = [\n    '-project', path.join(BOOTSTRAP_PATH, 'WebDriverAgent.xcodeproj'),\n    '-scheme', WDA_SCHEME,\n    '-sdk', SDK_SIMULATOR,\n    'CODE_SIGN_IDENTITY=\"\"',\n    'CODE_SIGNING_REQUIRED=\"NO\"',\n    'GCC_TREAT_WARNINGS_AS_ERRORS=0',\n  ];\n  await exec('xcodebuild', args);\n}\n\n// eslint-disable-next-line require-await\nasync function checkForDependencies () {\n  log.debug('Dependencies are up to date');\n  return false;\n}\n\nasync function bundleWDASim (xcodebuild, opts = {}) {\n  if (xcodebuild && !_.isFunction(xcodebuild.retrieveDerivedDataPath)) {\n    xcodebuild = new XcodeBuild();\n    opts = xcodebuild;\n  }\n\n  const derivedDataPath = await xcodebuild.retrieveDerivedDataPath();\n  const wdaBundlePath = path.join(derivedDataPath, 'Build', 'Products', 'Debug-iphonesimulator', WDA_RUNNER_APP);\n  if (await fs.exists(wdaBundlePath)) {\n    return wdaBundlePath;\n  }\n  await buildWDASim(xcodebuild, opts);\n  return wdaBundlePath;\n}\n\nexport { checkForDependencies, bundleWDASim };\n"],"mappings":";;;;;;;;;AAAA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,OAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,aAAA,GAAAH,OAAA;AACA,IAAAI,KAAA,GAAAF,sBAAA,CAAAF,OAAA;AACA,IAAAK,WAAA,GAAAH,sBAAA,CAAAF,OAAA;AACA,IAAAM,UAAA,GAAAN,OAAA;AAGA,IAAAO,MAAA,GAAAP,OAAA;AACA,IAAAQ,OAAA,GAAAN,sBAAA,CAAAF,OAAA;AAEA,eAAeS,WAAWA,CAAA,EAAI;EAC5B,MAAMC,IAAI,GAAG,CACX,UAAU,EAAEC,aAAI,CAACC,IAAI,CAACC,qBAAc,EAAE,0BAA0B,CAAC,EACjE,SAAS,EAAEC,qBAAU,EACrB,MAAM,EAAEC,wBAAa,EACrB,uBAAuB,EACvB,4BAA4B,EAC5B,gCAAgC,CACjC;EACD,MAAM,IAAAC,kBAAI,EAAC,YAAY,EAAEN,IAAI,CAAC;AAChC;AAGA,eAAeO,oBAAoBA,CAAA,EAAI;EACrCC,eAAG,CAACC,KAAK,CAAC,6BAA6B,CAAC;EACxC,OAAO,KAAK;AACd;AAEA,eAAeC,YAAYA,CAAEC,UAAU,EAAEC,IAAI,GAAG,CAAC,CAAC,EAAE;EAClD,IAAID,UAAU,IAAI,CAACE,eAAC,CAACC,UAAU,CAACH,UAAU,CAACI,uBAAuB,CAAC,EAAE;IACnEJ,UAAU,GAAG,IAAIK,mBAAU,EAAE;IAC7BJ,IAAI,GAAGD,UAAU;EACnB;EAEA,MAAMM,eAAe,GAAG,MAAMN,UAAU,CAACI,uBAAuB,EAAE;EAClE,MAAMG,aAAa,GAAGjB,aAAI,CAACC,IAAI,CAACe,eAAe,EAAE,OAAO,EAAE,UAAU,EAAE,uBAAuB,EAAEE,yBAAc,CAAC;EAC9G,IAAI,MAAMC,WAAE,CAACC,MAAM,CAACH,aAAa,CAAC,EAAE;IAClC,OAAOA,aAAa;EACtB;EACA,MAAMnB,WAAW,CAACY,UAAU,EAAEC,IAAI,CAAC;EACnC,OAAOM,aAAa;AACtB"}