"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
require("source-map-support/register");
var _rimraf = _interopRequireDefault(require("rimraf"));
var _uuid = require("uuid");
var _path = _interopRequireDefault(require("path"));
var _os = _interopRequireDefault(require("os"));
var _promises = _interopRequireDefault(require("fs/promises"));
const commands = {};
commands.getScreenshot = async function getScreenshot() {
  const udid = this.requireUdid('io screenshot');
  const pathToScreenshotPng = _path.default.resolve(_os.default.tmpdir(), `${(0, _uuid.v4)()}.png`);
  try {
    await this.exec('io', {
      args: [udid, 'screenshot', pathToScreenshotPng]
    });
    return (await _promises.default.readFile(pathToScreenshotPng)).toString('base64');
  } finally {
    await (0, _rimraf.default)(pathToScreenshotPng);
  }
};
var _default = commands;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmltcmFmIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfdXVpZCIsIl9wYXRoIiwiX29zIiwiX3Byb21pc2VzIiwiY29tbWFuZHMiLCJnZXRTY3JlZW5zaG90IiwidWRpZCIsInJlcXVpcmVVZGlkIiwicGF0aFRvU2NyZWVuc2hvdFBuZyIsInBhdGgiLCJyZXNvbHZlIiwib3MiLCJ0bXBkaXIiLCJ1dWlkVjQiLCJleGVjIiwiYXJncyIsImZzIiwicmVhZEZpbGUiLCJ0b1N0cmluZyIsInJpbXJhZiIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlcyI6WyIuLi8uLi8uLi9saWIvc3ViY29tbWFuZHMvaW8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHJpbXJhZiBmcm9tICdyaW1yYWYnO1xuaW1wb3J0IHsgdjQgYXMgdXVpZFY0IH0gZnJvbSAndXVpZCc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBvcyBmcm9tICdvcyc7XG5pbXBvcnQgZnMgZnJvbSAnZnMvcHJvbWlzZXMnO1xuXG5jb25zdCBjb21tYW5kcyA9IHt9O1xuXG4vKipcbiAqIEdldHMgYmFzZTY0IHNjcmVlbnNob3QgZm9yIGRldmljZVxuICogSXQgaXMgcmVxdWlyZWQgdGhhdCBTaW11bGF0b3IgaXMgaW4gX2Jvb3RlZF8gc3RhdGUuXG4gKlxuICogQHNpbmNlIFhjb2RlIFNESyA4LjFcbiAqIEByZXR1cm4ge3N0cmluZ30gQmFzZTY0LWVuY29kZWQgU2ltdWxhdG9yIHNjcmVlbnNob3QuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZFxuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGB1ZGlkYCBpbnN0YW5jZSBwcm9wZXJ0eSBpcyB1bnNldFxuICovXG5jb21tYW5kcy5nZXRTY3JlZW5zaG90ID0gYXN5bmMgZnVuY3Rpb24gZ2V0U2NyZWVuc2hvdCAoKSB7XG4gIGNvbnN0IHVkaWQgPSB0aGlzLnJlcXVpcmVVZGlkKCdpbyBzY3JlZW5zaG90Jyk7XG4gIGNvbnN0IHBhdGhUb1NjcmVlbnNob3RQbmcgPSBwYXRoLnJlc29sdmUob3MudG1wZGlyKCksIGAke3V1aWRWNCgpfS5wbmdgKTtcbiAgdHJ5IHtcbiAgICBhd2FpdCB0aGlzLmV4ZWMoJ2lvJywge1xuICAgICAgYXJnczogW3VkaWQsICdzY3JlZW5zaG90JywgcGF0aFRvU2NyZWVuc2hvdFBuZ10sXG4gICAgfSk7XG4gICAgcmV0dXJuIChhd2FpdCBmcy5yZWFkRmlsZShwYXRoVG9TY3JlZW5zaG90UG5nKSkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICB9IGZpbmFsbHkge1xuICAgIGF3YWl0IHJpbXJhZihwYXRoVG9TY3JlZW5zaG90UG5nKTtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgY29tbWFuZHM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUEsSUFBQUEsT0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsS0FBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsS0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsR0FBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksU0FBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBRUEsTUFBTUssUUFBUSxHQUFHLENBQUMsQ0FBQztBQVluQkEsUUFBUSxDQUFDQyxhQUFhLEdBQUcsZUFBZUEsYUFBYUEsQ0FBQSxFQUFJO0VBQ3ZELE1BQU1DLElBQUksR0FBRyxJQUFJLENBQUNDLFdBQVcsQ0FBQyxlQUFlLENBQUM7RUFDOUMsTUFBTUMsbUJBQW1CLEdBQUdDLGFBQUksQ0FBQ0MsT0FBTyxDQUFDQyxXQUFFLENBQUNDLE1BQU0sRUFBRSxFQUFHLEdBQUUsSUFBQUMsUUFBTSxHQUFHLE1BQUssQ0FBQztFQUN4RSxJQUFJO0lBQ0YsTUFBTSxJQUFJLENBQUNDLElBQUksQ0FBQyxJQUFJLEVBQUU7TUFDcEJDLElBQUksRUFBRSxDQUFDVCxJQUFJLEVBQUUsWUFBWSxFQUFFRSxtQkFBbUI7SUFDaEQsQ0FBQyxDQUFDO0lBQ0YsT0FBTyxDQUFDLE1BQU1RLGlCQUFFLENBQUNDLFFBQVEsQ0FBQ1QsbUJBQW1CLENBQUMsRUFBRVUsUUFBUSxDQUFDLFFBQVEsQ0FBQztFQUNwRSxDQUFDLFNBQVM7SUFDUixNQUFNLElBQUFDLGVBQU0sRUFBQ1gsbUJBQW1CLENBQUM7RUFDbkM7QUFDRixDQUFDO0FBQUMsSUFBQVksUUFBQSxHQUVhaEIsUUFBUTtBQUFBaUIsT0FBQSxDQUFBQyxPQUFBLEdBQUFGLFFBQUEifQ==