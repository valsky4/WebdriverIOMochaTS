{"version":3,"file":"push.js","names":["_rimraf","_interopRequireDefault","require","_uuid","_path","_os","_promises","commands","pushNotification","payload","dstPath","path","resolve","os","tmpdir","uuidV4","fs","writeFile","JSON","stringify","exec","args","requireUdid","rimraf","_default","exports","default"],"sources":["../../../lib/subcommands/push.js"],"sourcesContent":["import rimraf from 'rimraf';\nimport { v4 as uuidV4 } from 'uuid';\nimport path from 'path';\nimport os from 'os';\nimport fs from 'fs/promises';\n\nconst commands = {};\n\n/**\n * Send a simulated push notification\n *\n * @since Xcode 11.4 SDK\n * @param {Object} payload - The object that describes Apple push notification content.\n * It must contain a top-level \"Simulator Target Bundle\" key with a string value matching\n * the target applicationâ€˜s bundle identifier and \"aps\" key with valid Apple Push Notification values.\n * For example:\n * {\n *   \"Simulator Target Bundle\": \"com.apple.Preferences\",\n *   \"aps\": {\n *     \"alert\": \"This is a simulated notification!\",\n *     \"badge\": 3,\n *     \"sound\": \"default\"\n *   }\n * }\n * @throws {Error} if the current SDK version does not support the command\n * or there was an error while pushing the notification\n * @throws {Error} If the `udid` instance property is unset\n */\ncommands.pushNotification = async function pushNotification (payload) {\n  const dstPath = path.resolve(os.tmpdir(), `${uuidV4()}.json`);\n  try {\n    await fs.writeFile(dstPath, JSON.stringify(payload), 'utf8');\n    await this.exec('push', {\n      args: [this.requireUdid('push'), dstPath],\n    });\n  } finally {\n    await rimraf(dstPath);\n  }\n};\n\nexport default commands;\n"],"mappings":";;;;;;;;AAAA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,KAAA,GAAAD,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,GAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,SAAA,GAAAL,sBAAA,CAAAC,OAAA;AAEA,MAAMK,QAAQ,GAAG,CAAC,CAAC;AAsBnBA,QAAQ,CAACC,gBAAgB,GAAG,eAAeA,gBAAgBA,CAAEC,OAAO,EAAE;EACpE,MAAMC,OAAO,GAAGC,aAAI,CAACC,OAAO,CAACC,WAAE,CAACC,MAAM,EAAE,EAAG,GAAE,IAAAC,QAAM,GAAG,OAAM,CAAC;EAC7D,IAAI;IACF,MAAMC,iBAAE,CAACC,SAAS,CAACP,OAAO,EAAEQ,IAAI,CAACC,SAAS,CAACV,OAAO,CAAC,EAAE,MAAM,CAAC;IAC5D,MAAM,IAAI,CAACW,IAAI,CAAC,MAAM,EAAE;MACtBC,IAAI,EAAE,CAAC,IAAI,CAACC,WAAW,CAAC,MAAM,CAAC,EAAEZ,OAAO;IAC1C,CAAC,CAAC;EACJ,CAAC,SAAS;IACR,MAAM,IAAAa,eAAM,EAACb,OAAO,CAAC;EACvB;AACF,CAAC;AAAC,IAAAc,QAAA,GAEajB,QAAQ;AAAAkB,OAAA,CAAAC,OAAA,GAAAF,QAAA"}